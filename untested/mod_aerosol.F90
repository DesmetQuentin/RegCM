      module mod_aerosol

      use mod_regcm_param

      implicit none

!     MODIF 16/09/2005 IBRAH Internal mixing

!
! PARAMETER definitions
!
      integer , parameter :: nspi = 19
      integer , parameter :: ncoefs = 5
!
! number of coefficients
! kscoef  - specific extinction (m2/g)
! wscoef  - single partical albedo
! gscoef  - asymmetry parameter
! ksbase  - specific extinction (m2/g) base
! wsbase  - single partical albedo base
! gsbase  - asymmetry parameter base
! ksdust  - specific extinction (m2/g) dust
! wsdust  - single partical albedo dust
! gsdust  - asymmetry parameter dust
!
      integer , private :: ii , jj ! coefficient index
!
      real(8) , dimension(nspi) :: gsbase , gsbc_hb , gsbc_hl ,         &
                                 & gsoc_hb , gsoc_hl , ksbase ,         &
                                 & ksbc_hb , ksbc_hl , ksoc_hb ,        &
                                 & ksoc_hl , wsbase , wsbc_hb ,         &
                                 & wsbc_hl , wsoc_hb , wsoc_hl
      real(8) , dimension(nspi,ncoefs) :: gscoef , kscoef , wscoef
      real(8) , dimension(nspi,4) :: gsdust , ksdust , wsdust
      real(4) , dimension(4,19,11,11,11,11) :: dextmix , dgmix , dssamix

!
!     Aerosol mass mixing ratio
!
#ifdef MPP1
      real(8) , dimension(ixm1,kx,jxp) :: aermm
#else
      real(8) , dimension(ixm1,kx,jxm1) :: aermm
#endif

!
!     Background aerosol mass mixing ratio
!
      real(8) , dimension(ixm1,kx) :: aermmb

!
!     Radiation level aerosol mass mixing ratio
!
      real(8) , dimension(ixm1,kx,ntr) :: aermmr

!------------------------------------------------------------------------------
!                  DATA SECTION
!------------------------------------------------------------------------------

      data ksbase/5.206 , 5.206 , 5.206 , 5.206 , 5.206 , 5.206 ,       &
         & 5.206 , 3.203 , 3.203 , 1.302 , 5.992E-01 , 2.948E-01 ,      &
         & 1.475E-01 , 7.387E-02 , 1.683E-01 , 2.655E-01 , 5.770E-02 ,  &
         & 2.290E-01 , 2.270E-01/
!
      data ((kscoef(ii,jj),jj=1,ncoefs),ii=1,nspi)/1.126E+01 ,          &
          & -2.502E-01 , -1.087E+00 , -1.794E+02 , 1.556E+01 ,          &
          & 1.126E+01 , -2.502E-01 , -1.087E+00 , -1.794E+02 ,          &
          & 1.556E+01 , 1.126E+01 , -2.502E-01 , -1.087E+00 ,           &
          & -1.794E+02 , 1.556E+01 , 1.126E+01 , -2.502E-01 ,           &
          & -1.087E+00 , -1.794E+02 , 1.556E+01 , 1.126E+01 ,           &
          & -2.502E-01 , -1.087E+00 , -1.794E+02 , 1.556E+01 ,          &
          & 1.126E+01 , -2.502E-01 , -1.087E+00 , -1.794E+02 ,          &
          & 1.556E+01 , 1.126E+01 , -2.502E-01 , -1.087E+00 ,           &
          & -1.794E+02 , 1.556E+01 , 1.124E+01 , -3.040E-01 ,           &
          & -1.088E+00 , -1.776E+02 , 1.537E+01 , 1.124E+01 ,           &
          & -3.040E-01 , -1.088E+00 , -1.776E+02 , 1.537E+01 ,          &
          & 1.222E+01 , -3.770E-01 , -1.089E+00 , -1.898E+02 ,          &
          & 1.504E+01 , 1.357E+01 , -4.190E-01 , -1.087E+00 ,           &
          & -2.070E+02 , 1.478E+01 , 1.557E+01 , -4.353E-01 ,           &
          & -1.083E+00 , -2.382E+02 , 1.486E+01 , 1.758E+01 ,           &
          & -4.389E-01 , -1.078E+00 , -2.716E+02 , 1.505E+01 ,          &
          & 1.597E+01 , -4.337E-01 , -1.073E+00 , -2.510E+02 ,          &
          & 1.527E+01 , 2.107E+01 , -3.041E-01 , -1.067E+00 ,           &
          & -2.494E+02 , 1.166E+01 , -2.424E-01 , -1.770E-01 ,          &
          & -1.032E+00 , 1.469E-01 , 1.947E+00 , 2.535E+01 ,            &
          & -2.270E-01 , -1.052E+00 , -2.528E+02 , 9.888E+00 ,          &
          & -1.545E-01 , -1.661E-01 , -1.030E+00 , -4.698E-04 ,         &
          & 7.275E-02 , 8.835E-01 , -1.590E-01 , -1.029E+00 ,           &
          & -2.838E+01 , 2.734E+01/
!
      data wsbase/7.371E-08 , 7.371E-08 , 7.371E-08 , 7.371E-08 ,       &
         & 7.371E-08 , 7.371E-08 , 7.371E-08 , 6.583E-08 , 6.583E-08 ,  &
         & 3.656E-06 , 4.919E-05 , 3.539E-03 , 2.855E-02 , 2.126E-01 ,  &
         & 8.433E-01 , 9.653E-01 , 6.198E-01 , 9.642E-01 , 9.699E-01/
!
      data ((wscoef(ii,jj),jj=1,ncoefs),ii=1,nspi)/2.492E+00 ,          &
          & -5.210E-02 , -1.036E+00 , -4.398E+01 , 1.724E+01 ,          &
          & 2.492E+00 , -5.210E-02 , -1.036E+00 , -4.398E+01 ,          &
          & 1.724E+01 , 2.492E+00 , -5.210E-02 , -1.036E+00 ,           &
          & -4.398E+01 , 1.724E+01 , 2.492E+00 , -5.210E-02 ,           &
          & -1.036E+00 , -4.398E+01 , 1.724E+01 , 2.492E+00 ,           &
          & -5.210E-02 , -1.036E+00 , -4.398E+01 , 1.724E+01 ,          &
          & 2.492E+00 , -5.210E-02 , -1.036E+00 , -4.398E+01 ,          &
          & 1.724E+01 , 2.492E+00 , -5.210E-02 , -1.036E+00 ,           &
          & -4.398E+01 , 1.724E+01 , 1.139E+00 , -1.110E-02 ,           &
          & -1.011E+00 , -7.754E+00 , 6.737E+00 , 1.139E+00 ,           &
          & -1.110E-02 , -1.011E+00 , -7.754E+00 , 6.737E+00 ,          &
          & 1.848E+00 , -3.920E-04 , -9.924E-01 , -1.607E+00 ,          &
          & 8.587E-01 , 5.459E+00 , 9.357E-01 , -1.626E+00 ,            &
          & -5.282E+00 , 1.066E+00 , 1.187E+00 , 2.241E-01 ,            &
          & -1.226E+00 , 1.442E+01 , -1.402E+01 , -3.640E+00 ,          &
          & 2.552E-01 , -1.168E+00 , 4.458E+01 , 1.152E+01 ,            &
          & -5.634E+00 , 2.068E-01 , -1.122E+00 , 7.528E+01 ,           &
          & 1.290E+01 , 1.826E-01 , 6.588E-02 , -1.098E+00 ,            &
          & -1.996E-02 , 1.618E-01 , 2.164E+00 , 1.194E-01 ,            &
          & -1.044E+00 , -3.221E+01 , 1.564E+01 , 2.268E-01 ,           &
          & 3.266E-02 , -1.064E+00 , -2.677E-02 , 1.309E-01 ,           &
          & 2.178E+00 , 1.151E-01 , -1.042E+00 , -3.325E+01 ,           &
          & 1.600E+01 , 1.713E+00 , 9.166E-02 , -1.039E+00 ,            &
          & -2.660E+01 , 1.629E+01/
!
      data gsbase/6.899E-01 , 6.899E-01 , 6.899E-01 , 6.899E-01 ,       &
         & 6.899E-01 , 6.899E-01 , 6.899E-01 , 6.632E-01 , 6.632E-01 ,  &
         & 5.912E-01 , 5.111E-01 , 4.269E-01 , 3.321E-01 , 2.197E-01 ,  &
         & 1.305E-01 , 7.356E-02 , 1.602E-01 , 6.883E-02 , 6.304E-02/
!
      data ((gscoef(ii,jj),jj=1,ncoefs),ii=1,nspi)/ - 9.874E-01 ,       &
          & -3.033E+01 , -2.138E+01 , -2.265E+00 , 5.238E+00 ,          &
          & -9.874E-01 , -3.033E+01 , -2.138E+01 , -2.265E+00 ,         &
          & 5.238E+00 , -9.874E-01 , -3.033E+01 , -2.138E+01 ,          &
          & -2.265E+00 , 5.238E+00 , -9.874E-01 , -3.033E+01 ,          &
          & -2.138E+01 , -2.265E+00 , 5.238E+00 , -9.874E-01 ,          &
          & -3.033E+01 , -2.138E+01 , -2.265E+00 , 5.238E+00 ,          &
          & -9.874E-01 , -3.033E+01 , -2.138E+01 , -2.265E+00 ,         &
          & 5.238E+00 , -9.874E-01 , -3.033E+01 , -2.138E+01 ,          &
          & -2.265E+00 , 5.238E+00 , -3.666E-01 , -1.319E+00 ,          &
          & -3.311E+00 , -2.821E-02 , 8.844E-01 , -3.666E-01 ,          &
          & -1.319E+00 , -3.311E+00 , -2.821E-02 , 8.844E-01 ,          &
          & 5.824E-01 , -1.875E-01 , -1.567E+00 , -4.402E+00 ,          &
          & 6.268E+00 , 1.238E+00 , -1.550E-01 , -1.368E+00 ,           &
          & -1.127E+01 , 8.334E+00 , 2.299E+00 , -1.686E-01 ,           &
          & -1.304E+00 , -2.677E+01 , 1.101E+01 , 3.037E+00 ,           &
          & -1.447E-01 , -1.223E+00 , -2.609E+01 , 8.267E+00 ,          &
          & 4.683E+00 , -2.307E-01 , -1.241E+00 , -4.312E+01 ,          &
          & 8.838E+00 , 3.842E+00 , -6.301E-01 , -1.367E+00 ,           &
          & -4.144E+01 , 9.620E+00 , 3.237E+00 , -4.530E-01 ,           &
          & -1.204E+00 , -3.234E+01 , 8.946E+00 , 4.181E+00 ,           &
          & -4.140E-01 , -1.284E+00 , -4.489E+01 , 9.950E+00 ,          &
          & 3.378E+00 , -4.334E-01 , -1.188E+00 , -3.664E+01 ,          &
          & 9.786E+00 , 3.943E+00 , -3.952E-01 , -1.170E+00 ,           &
          & -4.415E+01 , 1.031E+01/
!
!-----------------------------------------------------------------------
!
      data ksbc_hb/20.783 , 17.212 , 15.864 , 15.053 , 14.304 , 13.613 ,&
         & 11.966 , 6.5782 , 4.3961 , 4.38 , 2.11 , 2.11 , 2.11 , 2.11 ,&
         & 1.40 , 1.40 , 1.40 , 1.40 , 1.40/
 
      data wsbc_hb/0.24524 , 0.20962 , 0.195 , 0.18586 , 0.17719 ,      &
         & 0.16897 , 0.14849 , 0.071748 , 0.037536 , .089 , .025 ,      &
         & .025 , .025 , .025 , .009 , .009 , .009 , .009 , .009/
 
 
      data gsbc_hb/0.21387 , 0.17154 , 0.15564 , 0.1461 , 0.13732 ,     &
         & 0.12923 , 0.11006 , 0.049175 , 0.026638 , .220 , .123 ,      &
         & .123 , .123 , .123 , .073 , .073 , .073 , .073 , .073/
 
!----------------------------------------------------------------------

      data ksbc_hl/14.851 , 14.258 , 13.943 , 13.724 , 13.507 , 13.295 ,&
         & 12.722 , 9.4434 , 6.9653 , 4.38 , 2.11 , 2.11 , 2.11 , 2.11 ,&
         & 1.40 , 1.40 , 1.40 , 1.40 , 1.40/
 
      data wsbc_hl/0.46081 , 0.44933 , 0.44397 , 0.44065 , 0.43737 ,    &
         & 0.43394 , 0.42346 , 0.35913 , 0.29579 , .089 , .025 , .025 , &
         & .025 , .025 , .009 , .009 , .009 , .009 , .009/
 
      data gsbc_hl/0.69038 , 0.65449 , 0.63711 , 0.62542 , 0.61407 ,    &
         & 0.60319 , 0.57467 , 0.4205 , 0.3066 , .220 , .123 , .123 ,   &
         & .123 , .123 , .073 , .073 , .073 , .073 , .073/
 
!---------------------------------------------------------------------

      data ksoc_hb/6.0584 , 6.0654 , 6.1179 , 6.0102 , 5.8 , 5.6957 ,   &
         & 5.6494 , 4.3283 , 3.1485 , 1.302 , 5.992E-01 , 2.948E-01 ,   &
         & 1.475E-01 , 7.387E-02 , 1.683E-01 , 2.655E-01 , 5.770E-02 ,  &
         & 2.290E-01 , 2.270E-01/
 
      data wsoc_hb/0.91735 , 0.92365 , 0.92941 , 0.93067 , 0.93311 ,    &
         & 0.93766 , 0.94042 , 0.95343 , 0.9548 , 0.70566 , 0.70566 ,   &
         & 0.70566 , 0.70566 , 0.70566 , 0.70566 , 0.70566 , 0.70566 ,  &
         & 0.70566 , 0.70566/
 
      data gsoc_hb/0.67489 , 0.67003 , 0.67725 , 0.65487 , 0.65117 ,    &
         & 0.66116 , 0.64547 , 0.60033 , 0.55389 , 5.912E-01 ,          &
         & 5.111E-01 , 4.269E-01 , 3.321E-01 , 2.197E-01 , 1.305E-01 ,  &
         & 7.356E-02 , 1.602E-01 , 6.883E-02 , 6.304E-02/
 
!---------------------------------------------------------------------

      data ksoc_hl/3.543 , 3.623 , 3.7155 , 3.712 , 3.6451 , 3.6376 ,   &
         & 3.6844 , 3.4588 , 2.9846 , 1.302 , 5.992E-01 , 2.948E-01 ,   &
         & 1.475E-01 , 7.387E-02 , 1.683E-01 , 2.655E-01 , 5.770E-02 ,  &
         & 2.290E-01 , 2.270E-01/
 
      data wsoc_hl/0.87931 , 0.88292 , 0.89214 , 0.89631 , 0.89996 ,    &
         & 0.9054 , 0.90805 , 0.93423 , 0.95012 , 0.85546 , 0.85546 ,   &
         & 0.85546 , 0.85546 , 0.85546 , 0.85546 , 0.85546 , 0.85546 ,  &
         & 0.85546 , 0.85546/
 
      data gsoc_hl/0.73126 , 0.71089 , 0.72042 , 0.69924 , 0.69908 ,    &
         & 0.70696 , 0.68479 , 0.64879 , 0.63433 , 5.912E-01 ,          &
         & 5.111E-01 , 4.269E-01 , 3.321E-01 , 2.197E-01 , 1.305E-01 ,  &
         & 7.356E-02 , 1.602E-01 , 6.883E-02 , 6.304E-02/
 
!     DUST OP data base for external mixing : maximum of 4 bin for the
!     momeent , determined from Zender et al.
 
      data ((ksdust(ii,jj),jj=1,4),ii=1,nspi)/1.8801 , 0.76017 ,        &
          & 0.36681 , 0.16933 , 2.0254 , 0.78378 , 0.36845 , 0.17002 ,  &
          & 1.9547 , 0.76389 , 0.37119 , 0.17032 , 1.8996 , 0.74916 ,   &
          & 0.3722 , 0.17052 , 1.7946 , 0.74044 , 0.36984 , 0.17072 ,   &
          & 1.7149 , 0.75401 , 0.36892 , 0.1709 , 1.5431 , 0.82322 ,    &
          & 0.37505 , 0.17143 , 2.4482 , 0.8568 , 0.38078 , 0.17396 ,   &
          & 3.1067 , 0.74488 , 0.43688 , 0.18104 , 0.50391 , 0.67245 ,  &
          & 0.53605 , 0.20599 , 0.50391 , 0.67245 , 0.53605 , 0.20599 , &
          & 0.50391 , 0.67245 , 0.53605 , 0.20599 , 0.50391 , 0.67245 , &
          & 0.53605 , 0.20599 , 0.50391 , 0.67245 , 0.53605 , 0.20599 , &
          & 0.50391 , 0.67245 , 0.53605 , 0.20599 , 0.50391 , 0.67245 , &
          & 0.53605 , 0.20599 , 0.50391 , 0.67245 , 0.53605 , 0.20599 , &
          & 0.50391 , 0.67245 , 0.53605 , 0.20599 , 0.50391 , 0.67245 , &
          & 0.53605 , 0.20599/
 
      data ((wsdust(ii,jj),jj=1,4),ii=1,nspi)/0.64328 , 0.55196 ,       &
          & 0.53748 , 0.54342 , 0.67757 , 0.56909 , 0.53639 , 0.54232 , &
          & 0.67316 , 0.56027 , 0.53875 , 0.54181 , 0.66245 , 0.55338 , &
          & 0.53947 , 0.54149 , 0.68132 , 0.5744 , 0.54328 , 0.54143 ,  &
          & 0.6796 , 0.58467 , 0.54242 , 0.54113 , 0.72679 , 0.68744 ,  &
          & 0.58564 , 0.54576 , 0.9473 , 0.88181 , 0.80761 , 0.70455 ,  &
          & 0.97536 , 0.89161 , 0.86378 , 0.758 , 0.89568 , 0.96322 ,   &
          & 0.95008 , 0.89293 , 0.89568 , 0.96322 , 0.95008 , 0.89293 , &
          & 0.89568 , 0.96322 , 0.95008 , 0.89293 , 0.89568 , 0.96322 , &
          & 0.95008 , 0.89293 , 0.89568 , 0.96322 , 0.95008 , 0.89293 , &
          & 0.89568 , 0.96322 , 0.95008 , 0.89293 , 0.89568 , 0.96322 , &
          & 0.95008 , 0.89293 , 0.89568 , 0.96322 , 0.95008 , 0.89293 , &
          & 0.89568 , 0.96322 , 0.95008 , 0.89293 , 0.89568 , 0.96322 , &
          & 0.95008 , 0.89293/
 
      data ((gsdust(ii,jj),jj=1,4),ii=1,nspi)/0.87114 , 0.92556 ,       &
          & 0.94542 , 0.94831 , 0.86127 , 0.921 , 0.94355 , 0.94813 ,   &
          & 0.838 , 0.91194 , 0.94304 , 0.94803 , 0.8176 , 0.90442 ,    &
          & 0.94239 , 0.94796 , 0.77088 , 0.88517 , 0.9371 , 0.94775 ,  &
          & 0.73925 , 0.88364 , 0.93548 , 0.94763 , 0.60695 , 0.86086 , &
          & 0.91824 , 0.94473 , 0.64393 , 0.76457 , 0.8133 , 0.87784 ,  &
          & 0.7476 , 0.62041 , 0.80665 , 0.85974 , 0.26761 , 0.56045 ,  &
          & 0.68897 , 0.68174 , 0.26761 , 0.56045 , 0.68897 , 0.68174 , &
          & 0.26761 , 0.56045 , 0.68897 , 0.68174 , 0.26761 , 0.56045 , &
          & 0.68897 , 0.68174 , 0.26761 , 0.56045 , 0.68897 , 0.68174 , &
          & 0.26761 , 0.56045 , 0.68897 , 0.68174 , 0.26761 , 0.56045 , &
          & 0.68897 , 0.68174 , 0.26761 , 0.56045 , 0.68897 , 0.68174 , &
          & 0.26761 , 0.56045 , 0.68897 , 0.68174 , 0.26761 , 0.56045 , &
          & 0.68897 , 0.68174/
!
      end module mod_aerosol
