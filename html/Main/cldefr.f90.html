<HTML>

<HEAD>
<TITLE>cldefr.f90</TITLE>
</HEAD>

<BODY background="back_granite.gif">
<FONT COLOR="#000000" FACE="Times">
<H1 ALIGN=CENTER>cldefr.f90</H1>
<HR>
<H2 ALIGN=CENTER>cldefr.f90</H2>
<HR>
</FONT>

<HR>

<PRE>
1: !::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
2: !
3: !    This file is part of ICTP RegCM.
4: !
5: !    ICTP RegCM is free software: you can redistribute it and/or modify
6: !    it under the terms of the GNU General Public License as published by
7: !    the Free Software Foundation, either version 3 of the License, or
8: !    (at your option) any later version.
9: !
10: !    ICTP RegCM is distributed in the hope that it will be useful,
11: !    but WITHOUT ANY WARRANTY; without even the implied warranty of
12: !    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
13: !    GNU General Public License for more details.
14: !
15: !    You should have received a copy of the GNU General Public License
16: !    along with ICTP RegCM.  If not, see <http://www.gnu.org/licenses/>.
17: !
18: !::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
19:  
<p><a name=cldefr><H3>cldefr</H3></a></p> Click <a href="./callingtree/cldefr_rite.html" TARGET=RITE_PANEL>HERE</a> to see the where cldefr is used.
<hr>
20:       subroutine cldefr(ioro,t,rel,rei,fice,ps,pmid)
21: !-----------------------------------------------------------------------
22: !
23: ! Compute cloud drop size
24: !
25: !---------------------------Code history--------------------------------
26: !
27: ! Original version:  J. Kiehl, January 1993
28: !
29: !-----------------------------------------------------------------------
30: !
31:       use <a href="./mod_dynparam.F90.html#mod_dynparam" TARGET=CENT_PANEL>mod_dynparam</a>
32:       implicit none
33: !
34: !------------------------------Arguments--------------------------------
35: !
36: !     Input arguments
37: !
38: ! ioro   - nint(oro(i))
39: ! t      - Temperature
40: ! ps     - surface pressure
41: ! pmid   - midpoint pressures
42: !
43: !     Output arguments
44: !
45: ! rel    - liquid effective drop size (microns)
46: ! rei    - ice effective drop size (microns)
47: ! fice   - fractional ice content within cloud
48: ! pirnge - nrmlzd pres range for ice particle changes
49: ! picemn - normalized pressure below which rei=reimax
50: ! rirnge - range of ice radii (reimax - 10 microns)
51: ! reimax - maximum ice effective radius
52: ! pnrml  - normalized pressure
53: ! weight - coef. for determining rei as fn of P/PS
54: !
55: !
56: ! Dummy arguments
57: !
58:       real(8) , dimension(iym1,kz) :: fice , pmid , rei , rel , t
59:       integer , dimension(iym1) :: ioro
60:       real(8) , dimension(iym1) :: ps
61:       intent (in) ioro , pmid , ps , t
62:       intent (out) fice , rei , rel
63: !
64: !---------------------------Local workspace-----------------------------
65: !
66: ! i, k   - longitude, level indices
67: ! rliq   - temporary liquid drop size
68: !
69: !-----------------------------------------------------------------------
70: !
71: ! Local variables
72: !
73:       integer :: i , k
74:       real(8) :: picemn , pirnge , pnrml , reimax , rirnge , rliq ,     &
75:                & weight
76: !
77:       do k = 1 , kz
78:         do i = 1 , iym1
79: !
80: !         Define liquid drop size
81: !
82:           if ( ioro(i).ne.1 ) then
83: !
84: !           Effective liquid radius over ocean and sea ice
85: !
86:             rliq = 10.0
87:           else
88: !
89: !           Effective liquid radius over land
90: !
91:             rliq = 5.0 + 5.0*dmin1(1.D0,dmax1(0.D0,(263.16-t(i,k))*0.05)&
92:                  & )
93:           end if
94: !
95:           rel(i,k) = rliq
96: !fil
97: !         test radius = 10.0
98: !         rel(i,k) = 10.0
99: !fil
100: !+        rei(i,k) = 30.0
101: !
102: !         Determine rei as function of normalized pressure
103: !
104:           reimax = 30.0
105:           rirnge = 20.0
106:           pirnge = 0.4
107:           picemn = 0.4
108: !
109:           pnrml = pmid(i,k)/ps(i)
110:           weight = dmax1(dmin1((pnrml-picemn)/pirnge,1.D0),0.D0)
111:           rei(i,k) = reimax - rirnge*weight
112: !
113: !         Define fractional amount of cloud that is ice
114: !
115: !         if warmer than -10 degrees C then water phase
116: !
117:           if ( t(i,k).gt.263.16 ) fice(i,k) = 0.0
118: !
119: !         if colder than -10 degrees C but warmer than -30 C mixed phase
120: !
121:           if ( t(i,k).le.263.16 .and. t(i,k).ge.243.16 ) fice(i,k)      &
122:              & = (263.16-t(i,k))/20.0
123: !
124: !         if colder than -30 degrees C then ice phase
125: !
126:           if ( t(i,k).lt.243.16 ) fice(i,k) = 1.0
127: !
128: !         Turn off ice radiative properties by setting fice = 0.0
129: !
130: !fil      no-ice test
131: !         fice(i,k) = 0.0
132: !
133:         end do
134:       end do
135: !
136:       end subroutine cldefr
</PRE>

<HR>

</BODY>
</HTML>
