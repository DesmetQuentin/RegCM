<HTML>

<HEAD>
<TITLE>trcplk.f90</TITLE>
</HEAD>

<BODY background="back_granite.gif">
<FONT COLOR="#000000" FACE="Times">
<H1 ALIGN=CENTER>trcplk.f90</H1>
<HR>
<H2 ALIGN=CENTER>trcplk.f90</H2>
<HR>
</FONT>

<HR>

<PRE>
1: !::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
2: !
3: !    This file is part of ICTP RegCM.
4: !
5: !    ICTP RegCM is free software: you can redistribute it and/or modify
6: !    it under the terms of the GNU General Public License as published by
7: !    the Free Software Foundation, either version 3 of the License, or
8: !    (at your option) any later version.
9: !
10: !    ICTP RegCM is distributed in the hope that it will be useful,
11: !    but WITHOUT ANY WARRANTY; without even the implied warranty of
12: !    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
13: !    GNU General Public License for more details.
14: !
15: !    You should have received a copy of the GNU General Public License
16: !    along with ICTP RegCM.  If not, see <http://www.gnu.org/licenses/>.
17: !
18: !::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
19:  
<p><a name=trcplk><H3>trcplk</H3></a></p> Click <a href="./callingtree/trcplk_rite.html" TARGET=RITE_PANEL>HERE</a> to see the where trcplk is used.
<hr>
20:       subroutine trcplk(tint,tlayr,tplnke,emplnk,abplnk1,abplnk2)
21: !
22:       use <a href="./mod_dynparam.F90.html#mod_dynparam" TARGET=CENT_PANEL>mod_dynparam</a>
23:       implicit none
24: !
25: !----------------------------------------------------------------------
26: !   Calculate Planck factors for absorptivity and emissivity of
27: !   CH4, N2O, CFC11 and CFC12
28: !
29: !-----------------------------------------------------------------------
30: !
31: ! Input arguments
32: !
33: ! tint    - interface temperatures
34: ! tlayr   - k-1 level temperatures
35: ! tplnke  - Top Layer temperature
36: !
37: ! output arguments
38: !
39: ! emplnk  - emissivity Planck factor
40: ! abplnk1 - non-nearest layer Plack factor
41: ! abplnk2 - nearest layer factor
42: !
43: ! Dummy arguments
44: !
45:       real(8) , dimension(14,iym1,kzp1) :: abplnk1 , abplnk2
46:       real(8) , dimension(14,iym1) :: emplnk
47:       real(8) , dimension(iym1,kzp1) :: tint , tlayr
48:       real(8) , dimension(iym1) :: tplnke
49:       intent (in) tint , tlayr , tplnke
50:       intent (out) abplnk1 , abplnk2 , emplnk
51: !
52: ! Local variables
53: !
54: ! wvl   - wavelength index
55: ! f1    - Planck function factor
56: ! f2    -       "
57: ! f3    -       "
58: !
59:       real(8) , dimension(14) :: f1 , f2 , f3
60:       integer :: i , k , wvl
61: !
62:       data f1/5.85713D8 , 7.94950D8 , 1.47009D9 , 1.40031D9 ,           &
63:          & 1.34853D8 , 1.05158D9 , 3.35370D8 , 3.99601D8 , 5.35994D8 ,  &
64:          & 8.42955D8 , 4.63682D8 , 5.18944D8 , 8.83202D8 , 1.03279D9/
65:                                     !        "
66:       data f2/2.02493D11 , 3.04286D11 , 6.90698D11 , 6.47333D11 ,       &
67:          & 2.85744D10 , 4.41862D11 , 9.62780D10 , 1.21618D11 ,          &
68:          & 1.79905D11 , 3.29029D11 , 1.48294D11 , 1.72315D11 ,          &
69:          & 3.50140D11 , 4.31364D11/
70:       data f3/1383.D0 , 1531.D0 , 1879.D0 , 1849.D0 , 848.D0 , 1681.D0 ,&
71:          & 1148.D0 , 1217.D0 , 1343.D0 , 1561.D0 , 1279.D0 , 1328.D0 ,  &
72:          & 1586.D0 , 1671.D0/
73: !
74: !     Calculate emissivity Planck factor
75: !
76:       do wvl = 1 , 14
77:         do i = 1 , iym1
78:           emplnk(wvl,i) = f1(wvl)                                       &
79:                         & /(tplnke(i)**4.0*(dexp(f3(wvl)/tplnke(i))-1.0)&
80:                         & )
81:         end do
82:       end do
83: !
84: !     Calculate absorptivity Planck factor for tint and tlayr temperatures
85: !
86:       do wvl = 1 , 14
87:         do k = 1 , kzp1
88:           do i = 1 , iym1
89: !           non-nearlest layer function
90:             abplnk1(wvl,i,k) = (f2(wvl)*dexp(f3(wvl)/tint(i,k)))        &
91:                              & /(tint(i,k)                              &
92:                              & **5.0*(dexp(f3(wvl)/tint(i,k))-1.0)**2.0)
93: !           nearest layer function
94:             abplnk2(wvl,i,k) = (f2(wvl)*dexp(f3(wvl)/tlayr(i,k)))       &
95:                              & /(tlayr(i,k)                             &
96:                              & **5.0*(dexp(f3(wvl)/tlayr(i,k))-1.0)     &
97:                              & **2.0)
98:           end do
99:         end do
100:       end do
101: 
102:       end subroutine trcplk
</PRE>

<HR>

</BODY>
</HTML>
