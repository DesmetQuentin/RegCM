<HTML>

<HEAD>
<TITLE>clmtypeInitMod.F90.patch</TITLE>
</HEAD>

<BODY background="back_granite.gif">
<FONT COLOR="#000000" FACE="Times">
<H1 ALIGN=CENTER>clmlib/patchset/clmtypeInitMod.F90.patch</H1>
<HR>
<H2 ALIGN=CENTER>clmtypeInitMod.F90.patch</H2>
<HR>
</FONT>

<HR>

<PRE>
<OL>
<LI>--- orig/clmtypeInitMod.F90	2010-03-10 16:34:21.000000000 +0100
<LI>+++ patchd/clmtypeInitMod.F90	2010-03-10 16:27:57.028600316 +0100
<LI>@@ -16,6 +16,9 @@
<LI>   use nanMod
<LI>   use clmtype
<LI>   use clm_varpar, only: maxpatch_pft, nlevsno, nlevsoi, numrad, nlevlak, numpft, ndst, nvoc
<LI>+!abt added below
<LI>+  use clm_varvoc, only: n24,n240
<LI>+!abt added above
<LI> !
<LI> ! !PUBLIC TYPES:
<LI>   implicit none
<LI>@@ -62,6 +65,10 @@
<LI>   private :: init_landunit_pstate_type
<LI>   private :: init_gridcell_pstate_type
<LI>   private :: init_gridcell_wflux_type
<LI>+! abt below
<LI>+  private :: init_gridcell_ef_map_type
<LI>+  private :: init_voc_accum_type
<LI>+! abt above
<LI> !EOP
<LI> !----------------------------------------------------
<LI> 
<LI>@@ -118,6 +125,16 @@
<LI>     call init_landunit_type(begl, endl, clm3%g%l)
<LI>     call init_gridcell_type(begg, endg, clm3%g)
<LI> 
<LI>+#if (defined VOC)
<LI>+    ! biogenic emission factors                              !abt
<LI>+
<LI>+    call init_gridcell_ef_map_type(begg, endg, clm3%g%gem)   !abt
<LI>+
<LI>+    ! biogenic emission accumulation variables               !abt
<LI>+
<LI>+    call init_voc_accum_type(begp, endp, clm3%g%l%c%p%pva)   !abt
<LI>+#endif
<LI>+
<LI>     ! pft ecophysiological constants
<LI> 
<LI>     call init_pft_ecophys_constants()
<LI>@@ -515,6 +532,131 @@
<LI> 
<LI>   end subroutine init_water_balance_type
<LI> 
<LI>+
<LI>+!!!!!! abt rcm below
<LI>+!------------------------------------------------------------------------
<LI>+!BOP
<LI>+!
<LI>+! !IROUTINE: init_gridcell_ef_map_type
<LI>+!
<LI>+! !INTERFACE:
<LI>+  subroutine init_gridcell_ef_map_type(beg, end, gem)
<LI>+!
<LI>+! !DESCRIPTION:
<LI>+! Initialize biogenic emission factor variables
<LI>+!
<LI>+! !ARGUMENTS:
<LI>+    implicit none
<LI>+    integer, intent(in) :: beg, end
<LI>+    type(gridcell_ef_map_type), intent(inout):: gem
<LI>+!
<LI>+! !REVISION HISTORY:
<LI>+! Created by Mariana Vertenstein
<LI>+!
<LI>+!EOP
<LI>+!------------------------------------------------------------------------
<LI>+
<LI>+    allocate(gem%epsilon_iso(beg:end))
<LI>+    allocate(gem%epsilon_mbo(beg:end))
<LI>+    allocate(gem%epsilon_bpin(beg:end))
<LI>+    allocate(gem%epsilon_apin(beg:end))
<LI>+    allocate(gem%epsilon_myrc(beg:end))
<LI>+    allocate(gem%epsilon_sabi(beg:end))
<LI>+    allocate(gem%epsilon_limo(beg:end))
<LI>+    allocate(gem%epsilon_acar(beg:end))
<LI>+    allocate(gem%epsilon_ocim(beg:end))
<LI>+    allocate(gem%epsilon_omtp(beg:end))
<LI>+    allocate(gem%epsilon_farn(beg:end))
<LI>+    allocate(gem%epsilon_bcar(beg:end))
<LI>+    allocate(gem%epsilon_osqt(beg:end))
<LI>+    allocate(gem%epsilon_meoh(beg:end))
<LI>+    allocate(gem%epsilon_acto(beg:end))
<LI>+    allocate(gem%epsilon_meth(beg:end))
<LI>+    allocate(gem%epsilon_no(beg:end))
<LI>+    allocate(gem%epsilon_acta(beg:end))
<LI>+    allocate(gem%epsilon_form(beg:end))
<LI>+    allocate(gem%epsilon_co(beg:end))
<LI>+
<LI>+    gem%epsilon_iso(beg:end) = nan
<LI>+    gem%epsilon_mbo(beg:end) = nan
<LI>+    gem%epsilon_bpin(beg:end) = nan
<LI>+    gem%epsilon_apin(beg:end) = nan
<LI>+    gem%epsilon_myrc(beg:end) = nan
<LI>+    gem%epsilon_sabi(beg:end) = nan
<LI>+    gem%epsilon_limo(beg:end) = nan
<LI>+    gem%epsilon_acar(beg:end) = nan
<LI>+    gem%epsilon_ocim(beg:end) = nan
<LI>+    gem%epsilon_omtp(beg:end) = nan
<LI>+    gem%epsilon_farn(beg:end) = nan
<LI>+    gem%epsilon_bcar(beg:end) = nan
<LI>+    gem%epsilon_osqt(beg:end) = nan
<LI>+    gem%epsilon_meoh(beg:end) = nan
<LI>+    gem%epsilon_acto(beg:end) = nan
<LI>+    gem%epsilon_meth(beg:end) = nan
<LI>+    gem%epsilon_no(beg:end)   = nan
<LI>+    gem%epsilon_acta(beg:end) = nan
<LI>+    gem%epsilon_form(beg:end) = nan
<LI>+    gem%epsilon_co(beg:end)   = nan
<LI>+
<LI>+  end subroutine init_gridcell_ef_map_type
<LI>+!!!!!! abt rcm above
<LI>+
<LI>+!!!!!! abt rcm below
<LI>+!------------------------------------------------------------------------
<LI>+!BOP
<LI>+!
<LI>+! !IROUTINE: init_voc_accum_type
<LI>+!
<LI>+! !INTERFACE:
<LI>+  subroutine init_voc_accum_type(beg, end, pva)
<LI>+!
<LI>+! !DESCRIPTION:
<LI>+! Initialize biogenic emission factor variables
<LI>+!
<LI>+! !ARGUMENTS:
<LI>+    implicit none
<LI>+    integer, intent(in) :: beg, end
<LI>+    type(voc_accum_type), intent(inout):: pva
<LI>+!
<LI>+! !REVISION HISTORY:
<LI>+! Created by Mariana Vertenstein
<LI>+!
<LI>+!EOP
<LI>+!------------------------------------------------------------------------
<LI>+
<LI>+!    allocate(pva%t_sum24(beg:end,n24))
<LI>+!    allocate(pva%t_sum240(beg:end,n240))
<LI>+!    allocate(pva%p_sum24su(beg:end,n24))
<LI>+!    allocate(pva%p_sum240su(beg:end,n240))
<LI>+!    allocate(pva%p_sum24sh(beg:end,n24))
<LI>+!    allocate(pva%p_sum240sh(beg:end,n240))
<LI>+
<LI>+!    pva%t_sum24(beg:end,n24)     = nan
<LI>+!    pva%t_sum240(beg:end,n240)   = nan 
<LI>+!    pva%p_sum24su(beg:end,n24)   = nan
<LI>+!    pva%p_sum240su(beg:end,n240) = nan
<LI>+!    pva%p_sum24sh(beg:end,n24)   = nan
<LI>+!    pva%p_sum240sh(beg:end,n240) = nan
<LI>+
<LI>+    allocate(pva%t_sum24(n24,beg:end))
<LI>+    allocate(pva%t_sum240(n240,beg:end))
<LI>+    allocate(pva%p_sum24su(n24,beg:end))
<LI>+    allocate(pva%p_sum240su(n240,beg:end))
<LI>+    allocate(pva%p_sum24sh(n24,beg:end))
<LI>+    allocate(pva%p_sum240sh(n240,beg:end))
<LI>+    allocate(pva%monlai(beg:end,2))
<LI>+
<LI>+    pva%t_sum24(n24,beg:end)     = nan
<LI>+    pva%t_sum240(n240,beg:end)   = nan 
<LI>+    pva%p_sum24su(n24,beg:end)   = nan
<LI>+    pva%p_sum240su(n240,beg:end) = nan
<LI>+    pva%p_sum24sh(n24,beg:end)   = nan
<LI>+    pva%p_sum240sh(n240,beg:end) = nan
<LI>+    pva%monlai(beg:end,2)        = nan
<LI>+
<LI>+  end subroutine init_voc_accum_type
<LI>+!!!!!! abt rcm above
<LI>+
<LI> !------------------------------------------------------------------------
<LI> !BOP
<LI> !
<LI>@@ -1538,6 +1680,9 @@
<LI>     allocate(pef%sha_alf(beg:end,1:numrad))
<LI>     allocate(pef%sun_aperlai(beg:end,1:numrad))
<LI>     allocate(pef%sha_aperlai(beg:end,1:numrad))
<LI>+!abt rcm below
<LI>+    allocate(pef%uvdrag(beg:end))
<LI>+!abt rcm below
<LI> 
<LI>     pef%sabg(beg:end) = nan
<LI>     pef%sabv(beg:end) = nan
<LI>@@ -1586,6 +1731,9 @@
<LI>     pef%sha_alf(beg:end,1:numrad) = nan
<LI>     pef%sun_aperlai(beg:end,1:numrad) = nan
<LI>     pef%sha_aperlai(beg:end,1:numrad) = nan
<LI>+!abt rcm below
<LI>+    pef%uvdrag(beg:end) = nan
<LI>+!abt rcm below
<LI> 
<LI>   end subroutine init_pft_eflux_type
<LI> 
<LI>@@ -2172,6 +2320,21 @@
<LI>     allocate(pvf%vocflx_3(beg:end))
<LI>     allocate(pvf%vocflx_4(beg:end))
<LI>     allocate(pvf%vocflx_5(beg:end))
<LI>+    allocate(pvf%vocflx_6(beg:end))   !abt added
<LI>+    allocate(pvf%vocflx_7(beg:end))   !abt added
<LI>+    allocate(pvf%vocflx_8(beg:end))   !abt added
<LI>+    allocate(pvf%vocflx_9(beg:end))   !abt added
<LI>+    allocate(pvf%vocflx_10(beg:end))   !abt added
<LI>+    allocate(pvf%vocflx_11(beg:end))   !abt added
<LI>+    allocate(pvf%vocflx_12(beg:end))   !abt added
<LI>+    allocate(pvf%vocflx_13(beg:end))   !abt added
<LI>+    allocate(pvf%vocflx_14(beg:end))   !abt added
<LI>+    allocate(pvf%vocflx_15(beg:end))   !abt added
<LI>+    allocate(pvf%vocflx_16(beg:end))   !abt added
<LI>+    allocate(pvf%vocflx_17(beg:end))   !abt added
<LI>+    allocate(pvf%vocflx_18(beg:end))   !abt added
<LI>+    allocate(pvf%vocflx_19(beg:end))   !abt added
<LI>+    allocate(pvf%vocflx_20(beg:end))   !abt added
<LI> 
<LI>     pvf%vocflx_tot(beg:end) = nan
<LI>     pvf%vocflx(beg:end,1:nvoc) = nan
<LI>@@ -2180,6 +2343,21 @@
<LI>     pvf%vocflx_3(beg:end) = nan
<LI>     pvf%vocflx_4(beg:end) = nan
<LI>     pvf%vocflx_5(beg:end) = nan
<LI>+    pvf%vocflx_6(beg:end) = nan    !abt added
<LI>+    pvf%vocflx_7(beg:end) = nan    !abt added
<LI>+    pvf%vocflx_8(beg:end) = nan    !abt added
<LI>+    pvf%vocflx_9(beg:end) = nan    !abt added
<LI>+    pvf%vocflx_10(beg:end) = nan    !abt added
<LI>+    pvf%vocflx_11(beg:end) = nan    !abt added
<LI>+    pvf%vocflx_12(beg:end) = nan    !abt added
<LI>+    pvf%vocflx_13(beg:end) = nan    !abt added
<LI>+    pvf%vocflx_14(beg:end) = nan    !abt added
<LI>+    pvf%vocflx_15(beg:end) = nan    !abt added
<LI>+    pvf%vocflx_16(beg:end) = nan    !abt added
<LI>+    pvf%vocflx_17(beg:end) = nan    !abt added
<LI>+    pvf%vocflx_18(beg:end) = nan    !abt added
<LI>+    pvf%vocflx_19(beg:end) = nan    !abt added
<LI>+    pvf%vocflx_20(beg:end) = nan    !abt added
<LI> 
<LI>   end subroutine init_pft_vflux_type
<LI> 
<LI>@@ -2391,6 +2569,7 @@
<LI>     allocate(ces%thm(beg:end))
<LI> 
<LI>     ces%t_grnd(beg:end) = nan
<LI>+!    ces%t_grnd(beg:end) = 0._r8
<LI>     ces%dt_grnd(beg:end) = nan
<LI>     ces%t_soisno(beg:end,-nlevsno+1:nlevsoi) = nan
<LI>     ces%t_lake(beg:end,1:nlevlak)= nan
</OL>
</PRE>

<HR>

</BODY>
</HTML>
