<HTML>

<HEAD>
<TITLE>BiogeophysicsLakeMod.F90.patch</TITLE>
</HEAD>

<BODY background="back_granite.gif">
<FONT COLOR="#000000" FACE="Times">
<H1 ALIGN=CENTER>clmlib/patchset/BiogeophysicsLakeMod.F90.patch</H1>
<HR>
<H2 ALIGN=CENTER>BiogeophysicsLakeMod.F90.patch</H2>
<HR>
</FONT>

<HR>

<PRE>
<OL>
<LI>--- orig/BiogeophysicsLakeMod.F90	2010-03-10 16:34:21.000000000 +0100
<LI>+++ patchd/BiogeophysicsLakeMod.F90	2010-03-10 16:19:07.000000000 +0100
<LI>@@ -158,6 +158,9 @@
<LI>     real(r8), pointer :: ram1(:)            ! aerodynamical resistance (s/m)
<LI>     real(r8), pointer :: errsoi(:)          ! soil/lake energy conservation error (W/m**2)
<LI>     real(r8), pointer :: t_lake(:,:)        ! lake temperature (Kelvin)
<LI>+!abt
<LI>+    real(r8), pointer :: uvdrag(:)          ! surface wind drag (m2/s2)
<LI>+!abt_
<LI> !
<LI> !EOP
<LI> !
<LI>@@ -312,6 +315,9 @@
<LI>     qflx_prec_grnd => clm3%g%l%c%p%pwf%qflx_prec_grnd
<LI>     qflx_evap_soi  => clm3%g%l%c%p%pwf%qflx_evap_soi
<LI>     qflx_evap_tot  => clm3%g%l%c%p%pwf%qflx_evap_tot
<LI>+!abt
<LI>+    uvdrag         => clm3%g%l%c%p%pef%uvdrag
<LI>+!abt_
<LI> 
<LI>     ! Determine step size
<LI> 
<LI>@@ -536,6 +542,10 @@
<LI>        eflx_lh_tot(p)   = htvp(c)*qflx_evap_soi(p)
<LI>        eflx_lh_grnd(p)  = htvp(c)*qflx_evap_soi(p)
<LI> 
<LI>+!abt *** Added uvdrag calculation so it can be passed to regcm
<LI>+       uvdrag(p) = forc_rho(g)/ram1(p)
<LI>+!abt_
<LI>+
<LI>        ! 2 m height air temperature
<LI>        t_ref2m(p) = thm(c) + temp1(p)*dth(p)*(1._r8/temp12m(p) - 1._r8/temp1(p))
<LI> 
</OL>
</PRE>

<HR>

</BODY>
</HTML>
