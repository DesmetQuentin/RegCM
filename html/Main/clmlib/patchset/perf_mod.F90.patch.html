<HTML>

<HEAD>
<TITLE>perf_mod.F90.patch</TITLE>
</HEAD>

<BODY background="back_granite.gif">
<FONT COLOR="#000000" FACE="Times">
<H1 ALIGN=CENTER>clmlib/patchset/perf_mod.F90.patch</H1>
<HR>
<H2 ALIGN=CENTER>perf_mod.F90.patch</H2>
<HR>
</FONT>

<HR>

<PRE>
<OL>
<LI>--- orig/perf_mod.F90	2010-03-10 16:34:21.000000000 +0100
<LI>+++ patchd/perf_mod.F90	2010-03-10 16:19:07.000000000 +0100
<LI>@@ -760,18 +760,20 @@
<LI>                           timing_barrier_out=profile_barrier, &
<LI>                           perf_single_file_out=profile_single_file )
<LI>     if ( MasterTask2 ) then
<LI>-       unitn = shr_file_getUnit()
<LI>-       write(6,*) 'Read in prof_inparm namelist from: '//trim(NLFilename)
<LI>-       ierr = 1
<LI>-       open( unitn, file=trim(NLFilename), status='old', iostat=ierr )
<LI>-       if (ierr .eq. 0) then
<LI>-          ierr = 1
<LI>-          do while( ierr > 0 )
<LI>-             read(unitn, nml=prof_inparm, iostat=ierr)
<LI>-          end do
<LI>-          close(unitn)
<LI>-       endif
<LI>-       call shr_file_freeUnit( unitn )
<LI>+!       unitn = shr_file_getUnit()
<LI>+!       write(6,*) 'Read in prof_inparm namelist from: '//trim(NLFilename)
<LI>+!       ierr = 1
<LI>+!abt comment below
<LI>+!       open( unitn, file=trim(NLFilename), status='old', iostat=ierr )
<LI>+!       if (ierr .eq. 0) then
<LI>+!          ierr = 1
<LI>+!          do while( ierr > 0 )
<LI>+!             read(unitn, nml=prof_inparm, iostat=ierr)
<LI>+!          end do
<LI>+!          close(unitn)
<LI>+!       endif
<LI>+!       call shr_file_freeUnit( unitn )
<LI>+       profile_disable = .true.
<LI>     endif
<LI>     ! This logic assumes that there will be only one MasterTask
<LI>     ! per communicator, and that this MasterTask is process 0.
</OL>
</PRE>

<HR>

</BODY>
</HTML>
