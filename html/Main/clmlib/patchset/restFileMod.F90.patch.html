<HTML>

<HEAD>
<TITLE>restFileMod.F90.patch</TITLE>
</HEAD>

<BODY background="back_granite.gif">
<FONT COLOR="#000000" FACE="Times">
<H1 ALIGN=CENTER>clmlib/patchset/restFileMod.F90.patch</H1>
<HR>
<H2 ALIGN=CENTER>restFileMod.F90.patch</H2>
<HR>
</FONT>

<HR>

<PRE>
<OL>
<LI>--- orig/restFileMod.F90	2010-03-10 16:34:21.000000000 +0100
<LI>+++ patchd/restFileMod.F90	2010-03-10 16:19:07.000000000 +0100
<LI>@@ -587,6 +587,7 @@
<LI>        call opnfil( filename, nio, 'f' )
<LI>        
<LI>        if (mss_irt == 0) then
<LI>+!abt changed          write(nio,'(a)') fnamer
<LI>           write(nio,'(a)') fnamer
<LI>        else
<LI>           rem_dir = trim(archive_dir) // '/rest/'
<LI>@@ -688,15 +689,15 @@
<LI>        write(cdate,'(i4.4,"-",i2.2,"-",i2.2,"-",i5.5)') yr,mon,day,sec
<LI>        
<LI>        if (trim(type) == 'binary') then
<LI>-          restFile_filename = "./"//trim(caseid)//".clm2.r."//trim(cdate)
<LI>+          restFile_filename = "./output/"//trim(caseid)//".clm2.r."//trim(cdate)
<LI>        else if (trim(type) == 'netcdf') then
<LI>-          if (present(offset)) then
<LI>-             restFile_filename = "./"//trim(caseid)//".clm2.i."//trim(cdate)//".nc"
<LI>-             write(6,*)'writing initial file ',trim(restFile_filename),' for model date = ',cdate
<LI>-          else
<LI>-             restFile_filename = "./"//trim(caseid)//".clm2.r."//trim(cdate)//".nc"
<LI>+!abt commented          if (present(offset)) then
<LI>+!             restFile_filename = "./"//trim(caseid)//".clm2.i."//trim(cdate)//".nc"
<LI>+!             write(6,*)'writing initial file ',trim(restFile_filename),' for model date = ',cdate
<LI>+!          else
<LI>+             restFile_filename = "./output/"//trim(caseid)//".clm2.r."//trim(cdate)//".nc"
<LI>              write(6,*)'writing restart file ',trim(restFile_filename),' for model date = ',cdate
<LI>-          end if
<LI>+!          end if
<LI>        else
<LI>           write(6,*)'restart file type ',trim(type),' is not supported'; call endrun()
<LI>        end if
<LI>@@ -793,7 +794,6 @@
<LI>        call check_ret( nf_def_dim(ncid, 'rtmlat'  , rtmlat         , dimid), subname )
<LI> #endif
<LI>        call check_ret( nf_def_dim(ncid, 'string_length', 64        , dimid), subname)
<LI>-       
<LI>        ! Define global attributes
<LI>        
<LI>        str = 'CF-1.0'
</OL>
</PRE>

<HR>

</BODY>
</HTML>
