<HTML>

<HEAD>
<TITLE>outsav.F90</TITLE>
</HEAD>

<BODY background="back_granite.gif">
<FONT COLOR="#000000" FACE="Times">
<H1 ALIGN=CENTER>outsav.F90</H1>
<HR>
<H2 ALIGN=CENTER>outsav.F90</H2>
<HR>
</FONT>

<HR>

<PRE>
1: !::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
2: !
3: !    This file is part of ICTP RegCM.
4: !
5: !    ICTP RegCM is free software: you can redistribute it and/or modify
6: !    it under the terms of the GNU General Public License as published by
7: !    the Free Software Foundation, either version 3 of the License, or
8: !    (at your option) any later version.
9: !
10: !    ICTP RegCM is distributed in the hope that it will be useful,
11: !    but WITHOUT ANY WARRANTY; without even the implied warranty of
12: !    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
13: !    GNU General Public License for more details.
14: !
15: !    You should have received a copy of the GNU General Public License
16: !    along with ICTP RegCM.  If not, see <http://www.gnu.org/licenses/>.
17: !
18: !::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
19:  
<p><a name=outsav><H3>outsav</H3></a></p> Click <a href="./callingtree/outsav_rite.html" TARGET=RITE_PANEL>HERE</a> to see the where outsav is used.
<hr>
20:       subroutine outsav(iutl)
21: 
22: !cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
23: !                                                                     c
24: !     this subroutine writes the model output for restart.            c
25: !                                                                     c
26: !     iutl : is the output unit number for large-domain variables.    c
27: !                                                                     c
28: !cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
29: 
30:       use <a href="./mod_dynparam.F90.html#mod_dynparam" TARGET=CENT_PANEL>mod_dynparam</a>
31:       use <a href="./mod_param2.F90.html#mod_param2" TARGET=CENT_PANEL>mod_param2</a>
32:       use <a href="./mod_main.F90.html#mod_main" TARGET=CENT_PANEL>mod_main</a>
33:       use <a href="./mod_bdycod.F90.html#mod_bdycod" TARGET=CENT_PANEL>mod_bdycod</a>
34:       use <a href="./mod_bats.F90.html#mod_bats" TARGET=CENT_PANEL>mod_bats</a>
35:       use <a href="./mod_date.F90.html#mod_date" TARGET=CENT_PANEL>mod_date</a> , only : mdate0 , lyear , lmonth , lday , lhour ,    &
36:                    & ldatez , ntime , ktau , xtime
37:       use <a href="./mod_iunits.f90.html#mod_iunits" TARGET=CENT_PANEL>mod_iunits</a>
38:       use <a href="./mod_radbuf.F90.html#mod_radbuf" TARGET=CENT_PANEL>mod_radbuf</a>
39:       use <a href="./mod_pmoist.F90.html#mod_pmoist" TARGET=CENT_PANEL>mod_pmoist</a>
40:       use <a href="./mod_mainchem.F90.html#mod_mainchem" TARGET=CENT_PANEL>mod_mainchem</a>
41:       use <a href="./mod_trachem.F90.html#mod_trachem" TARGET=CENT_PANEL>mod_trachem</a>
42:       use <a href="./mod_split.F90.html#mod_split" TARGET=CENT_PANEL>mod_split</a>
43:       use <a href="./mod_rad.F90.html#mod_rad" TARGET=CENT_PANEL>mod_rad</a>
44: #ifdef MPP1
45:       use <a href="./mod_mppio.F90.html#mod_mppio" TARGET=CENT_PANEL>mod_mppio</a>
46: #ifdef CLM
47:       use <a href="./mod_clm.F90.html#mod_clm" TARGET=CENT_PANEL>mod_clm</a>
48: #endif
49: #endif
50: #ifdef DIAG
51:       use <a href="./mod_diagnosis.f90.html#mod_diagnosis" TARGET=CENT_PANEL>mod_diagnosis</a>
52: #endif
53:       implicit none
54: !
55: ! Dummy arguments
56: !
57:       integer :: iutl
58:       intent (in) iutl
59: !
60: ! Local variables
61: !
62:       integer :: depth , freeze , ilake , j , jlake , n
63:       real(8) :: eta , hi , hii , hs
64:       real(8) , dimension(400) :: tlake
65: !
66: !-----output large-domain variables:
67: !
68:       write (iutl) mdate0
69:       write (iutl) ktau , xtime , ldatez , lyear , lmonth , lday ,      &
70:                  & lhour , ntime
71: #ifdef MPP1
72:       if ( ehso4 ) then
73:         write (iutl) ub0_io , vb0_io , qb0_io , tb0_io , ps0_io ,       &
74:                    & ts0_io , so0_io
75:       else
76:         write (iutl) ub0_io , vb0_io , qb0_io , tb0_io , ps0_io , ts0_io
77:       end if
78:       write (iutl) ua_io
79:       write (iutl) ub_io
80:       write (iutl) va_io
81:       write (iutl) vb_io
82:       write (iutl) ta_io
83:       write (iutl) tb_io
84:       write (iutl) qva_io
85:       write (iutl) qvb_io
86:       write (iutl) qca_io
87:       write (iutl) qcb_io
88:       write (iutl) psa_io , psb_io , satbrt_io , satbrt1_io , f_io
89:       write (iutl) ht_io , ht1_io , msfx_io , msfd_io , xlat_io ,       &
90:                  & xlong_io
91:       write (iutl) tga_io , tgb_io , rainc_io , rainnc_io
92:       if ( icup.eq.1 ) then
93:         write (iutl) rsheat_io , rswat_io
94:       else if ( icup.eq.3 ) then
95:         write (iutl) tbase_io , cldefi_io
96:       else if ( icup.eq.4 ) then
97:         write (iutl) cbmf2d_io
98:       else
99:       end if
100:       write (iutl) hfx_io , qfx_io , snowc_io , uvdrag_io
101: #ifdef DIAG
102:       write (iutl) tdini , tdadv , tqini , tqadv , tqeva , tqrai
103: #endif
104:       write (iutl) absnxt_io , abstot_io , emstot_io
105:       if ( ipptls.eq.1 ) write (iutl) fcc_io
106: #ifdef CLM
107:       write(iutl) sols2d_io
108:       write(iutl) soll2d_io
109:       write(iutl) solsd2d_io
110:       write(iutl) solld2d_io
111:       write(iutl) flwd2d_io
112:       write(iutl) aldirs2d_io
113:       write(iutl) aldirl2d_io
114:       write(iutl) aldifs2d_io
115:       write(iutl) aldifl2d_io
116:       write(iutl) coszrs2d_io
117:       write(iutl) ocld2d_io
118:       write(iutl) heatrt_io
119:       write(iutl) o3prof_io
120:       write (iutl) tgbb_io
121:       write (iutl) flw2d_io
122:       write (iutl) swt2d_io
123:       write (iutl) sinc2d_io
124:       write (iutl) fsw2d_io
125:       write (iutl) taf2d_io
126: #else
127:       write (iutl) sol2d_io , solvd2d_io , solvs2d_io , flw2d_io ,      &
128:                  & flwd2d_io , fsw2d_io , sabv2d_io , sinc2d_io
129:       write (iutl) taf2d_io , tlef2d_io , tgbb_io , ssw2d_io ,          &
130:                  & srw2d_io , tg2d_io , tgb2d_io , swt2d_io , scv2d_io ,&
131:                  & gwet2d_io , veg2d_io , veg2d1_io , sag2d_io ,        &
132:                  & sice2d_io , dew2d_io , ircp2d_io , text2d_io ,       &
133:                  & col2d_io , ocld2d_io , heatrt_io , o3prof_io
134: #endif
135:       write (iutl) pptnc_io , pptc_io , prca2d_io , prnca2d_io
136:       if ( iocnflx.eq.2 ) write (iutl) zpbl_io
137:       if ( ichem.eq.1 ) then
138:         write (iutl) chia_io
139:         write (iutl) chib_io
140:         write (iutl) remlsc_io
141:         write (iutl) remcvc_io
142:         write (iutl) remdrd_io
143:         write (iutl) ssw2da_io
144:         write (iutl) sdeltk2d_io
145:         write (iutl) sdelqk2d_io
146:         write (iutl) sfracv2d_io
147:         write (iutl) sfracb2d_io
148:         write (iutl) sfracs2d_io
149:         write (iutl) svegfrac2d_io
150: #ifdef DIAG
151:         write (iutl) tchiad
152:         write (iutl) tchitb
153:         write (iutl) tchie
154: #endif
155:       end if
156: #else
157:       if ( ehso4 ) then
158:         write (iutl) ub0 , vb0 , qb0 , tb0 , ps0 , ts0 , so0
159:       else
160:         write (iutl) ub0 , vb0 , qb0 , tb0 , ps0 , ts0
161:       end if
162:       write (iutl) ua
163:       write (iutl) ub
164:       write (iutl) va
165:       write (iutl) vb
166:       write (iutl) ta
167:       write (iutl) tb
168:       write (iutl) qva
169:       write (iutl) qvb
170:       write (iutl) qca
171:       write (iutl) qcb
172:       write (iutl) psa , psb , satbrt , satbrt1 , f
173:       write (iutl) ht , ht1 , msfx , msfd , xlat , xlong
174:       write (iutl) tga , tgb , rainc , rainnc
175:       if ( icup.eq.1 ) then
176:         write (iutl) rsheat , rswat
177:       else if ( icup.eq.3 ) then
178:         write (iutl) tbase , cldefi
179:       else if ( icup.eq.4 ) then
180:         write (iutl) cbmf2d
181:       else
182:       end if
183:       write (iutl) hfx , qfx , snowc , uvdrag
184: #ifdef DIAG
185:       write (iutl) tdini , tdadv , tqini , tqadv , tqeva , tqrai
186: #endif
187:       write (iutl) absnxt , abstot , emstot
188:       if ( ipptls.eq.1 ) write (iutl) fcc
189:       write (iutl) sol2d , solvd2d , solvs2d , flw2d , flwd2d , fsw2d , &
190:                  & sabv2d , sinc2d
191:       write (iutl) taf2d , tlef2d , tgbb , ssw2d , srw2d , tg2d ,       &
192:                  & tgb2d , swt2d , scv2d , gwet2d , veg2d , veg2d1 ,    &
193:                  & sag2d , sice2d , dew2d , ircp2d , text2d , col2d ,   &
194:                  & ocld2d , heatrt , o3prof
195:       write (iutl) pptnc , pptc , prca2d , prnca2d
196:       if ( iocnflx.eq.2 ) write (iutl) zpbl
197: 
198: !chem2
199:       if ( ichem.eq.1 ) then
200: !       pronostic concentrartions
201:         write (iutl) chia
202:         write (iutl) chib
203: !       cumul removal terms (3d, 2d)
204:         write (iutl) remlsc
205:         write (iutl) remcvc
206:         write (iutl) remdrd
207:         write (iutl) ssw2da
208:         write (iutl) sdeltk2d
209:         write (iutl) sdelqk2d
210:         write (iutl) sfracv2d
211:         write (iutl) sfracb2d
212:         write (iutl) sfracs2d
213:         write (iutl) svegfrac2d
214: !       cumul ad, dif, emis terms ( scalar)
215: #ifdef  DIAG
216:         write (iutl) tchiad
217:         write (iutl) tchitb
218:         write (iutl) tchie
219: #endif
220:       end if
221: !chem2_
222: #endif
223:  
224: !---lake model
225: !
226:       if ( lakemod.eq.1 ) then
227:         write (iutl) numpts
228:         print * , 'writing lake model restart file. numpts = ' , numpts
229:         do n = 1 , numpts
230:           read (iin) ilake , jlake , depth , freeze , hi , hii , hs ,   &
231:                    & eta , (tlake(j),j=1,depth)
232: !         print *,' in outsav ilake jlake = ',ilake,jlake
233:  
234:           write (iutl) ilake , jlake , depth , freeze , hi , hii , hs , &
235:                      & eta , (tlake(j),j=1,depth)
236:         end do
237:         rewind (iin)
238:       end if
239: !
240: #ifdef MPP1
241:       write (iutl) dstor_io
242:       write (iutl) hstor_io
243:       write (iutl) uj1 , uj2 , ujlx , ujl
244:       write (iutl) ui1_io , ui2_io , uilx_io , uil_io
245:       write (iutl) vj1 , vj2 , vjlx , vjl
246:       write (iutl) vi1_io , vi2_io , vilx_io , vil_io
247: #else
248:       write (iutl) dstor
249:       write (iutl) hstor
250:       write (iutl) uj1 , uj2 , ujlx , ujl
251:       write (iutl) ui1 , ui2 , uilx , uil
252:       write (iutl) vj1 , vj2 , vjlx , vjl
253:       write (iutl) vi1 , vi2 , vilx , vil
254: #endif
255:       end subroutine outsav
</PRE>

<HR>

</BODY>
</HTML>
