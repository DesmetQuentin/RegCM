<HTML>

<HEAD>
<TITLE>mod_mppio.F90</TITLE>
</HEAD>

<BODY background="back_granite.gif">
<FONT COLOR="#000000" FACE="Times">
<H1 ALIGN=CENTER>mod_mppio.F90</H1>
<HR>
<H2 ALIGN=CENTER>mod_mppio.F90</H2>
<HR>
</FONT>

<HR>

<PRE>
1: !::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
2: !
3: !    This file is part of ICTP RegCM.
4: !
5: !    ICTP RegCM is free software: you can redistribute it and/or modify
6: !    it under the terms of the GNU General Public License as published by
7: !    the Free Software Foundation, either version 3 of the License, or
8: !    (at your option) any later version.
9: !
10: !    ICTP RegCM is distributed in the hope that it will be useful,
11: !    but WITHOUT ANY WARRANTY; without even the implied warranty of
12: !    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
13: !    GNU General Public License for more details.
14: !
15: !    You should have received a copy of the GNU General Public License
16: !    along with ICTP RegCM.  If not, see <http://www.gnu.org/licenses/>.
17: !
18: !::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
19: 
<p><a name=mod_mppio><H3>mod_mppio</H3></a></p>20:       module mod_mppio
21: 
22:       use <a href="./mod_dynparam.F90.html#mod_dynparam" TARGET=CENT_PANEL>mod_dynparam</a>
23: 
24:       implicit none
25: 
26: #ifdef MPP1
27: !
28:       real(8) , allocatable , target , dimension(:,:,:,:) :: spacesubm1
29:       real(8) , allocatable , target , dimension(:,:,:,:) :: spacesub
30:       real(8) , allocatable , target , dimension(:,:,:) :: spacebat
31:       real(8) , allocatable , target , dimension(:,:,:) :: space2d
32:       real(8) , allocatable , target , dimension(:,:,:,:) :: space3d
33:       real(8) , allocatable , target , dimension(:,:,:) :: spacev
34:       real(8) , allocatable , target , dimension(:,:,:) :: spacesurf
35:       real(8) , allocatable , target , dimension(:,:,:,:) :: spaceair
36:       private :: spacesubm1 , spacesub , spacebat
37:       private :: space2d , space3d , spacev , spacesurf , spaceair
38: #ifdef CLM
39:       real(8) , allocatable , target , dimension(:,:,:) :: spaceclm
40:       private :: spaceclm
41: #endif
42: 
43:       real(8) , pointer , dimension(:,:,:) :: col2d_io , dew2d_io ,     &
44:            & evpa2d_io , gwet2d_io , ircp2d_io , ocld2d_io , rno2d_io , &
45:            & rnos2d_io , sag2d_io , scv2d_io , sena2d_io , sice2d_io ,  &
46:            & srw2d_io , ssw2d_io , swt2d_io , taf2d_io , text2d_io ,    &
47:            & tg2d_io , tgb2d_io , tlef2d_io , veg2d1_io
48: 
49:       real(8) , pointer , dimension(:,:,:) :: ht1_io , satbrt1_io ,     &
50:                                          &    snowc_io
51: !
52:       real(8) , pointer , dimension(:,:) :: flw2d_io , flwd2d_io ,      &
53:                           & fsw2d_io , sabv2d_io , sdelqk2d_io ,        &
54:                                      & sdeltk2d_io , sfracb2d_io ,      &
55:                                      & sfracs2d_io , sfracv2d_io ,      &
56:                                      & sinc2d_io , sol2d_io ,           &
57:                                      & solvd2d_io , solvs2d_io ,        &
58:                                      & ssw2da_io , svegfrac2d_io ,      &
59:                                      & veg2d_io
60:       
61:       real(4) , allocatable , dimension(:,:,:) :: fbat_io
62:       real(4) , allocatable , dimension(:,:,:,:) :: fsub_io
63: 
64:       real(4) , allocatable , dimension(:,:,:) :: frad2d_io
65:       real(4) , allocatable , dimension(:,:,:,:) :: frad3d_io
66: 
67:       real(8) , allocatable , dimension(:,:) :: cbmf2d_io
68:       real(8) , allocatable , dimension(:,:,:) :: fcc_io , rsheat_io ,  &
69:                                       & rswat_io
70: 
71:       real(8) , allocatable , dimension(:,:,:,:) :: absnxt_io
72:       real(8) , allocatable , dimension(:,:,:,:) :: abstot_io
73:       real(8) , allocatable , dimension(:,:,:) :: emstot_io
74: 
75:       real(8) , allocatable , dimension(:,:,:) :: heatrt_io
76:       real(8) , allocatable , dimension(:,:,:) :: o3prof_io
77: 
78:       real(8) , allocatable , dimension(:,:,:) :: dstor_io , hstor_io
79: 
80:       real(8) , allocatable , dimension(:,:,:) :: aerasp_io ,           &
81:                                 & aerext_io , aerssa_io
82:       real(8) , allocatable , dimension(:,:) :: aersrrf_io , aertarf_io,&
83:                               & aertalwrf_io , aersrlwrf_io
84:       real(8) , allocatable , dimension(:,:,:) :: cemtrac_io ,          &
85:                                 & cemtr_io , wxaq_io , wxsg_io
86:       real(8) , allocatable , dimension(:,:) :: dustsotex_io
87:       real(8) , allocatable , dimension(:,:,:,:) :: rxsaq1_io ,         &
88:                                 & rxsaq2_io , rxsg_io
89: 
90:       real(8) , allocatable , dimension(:,:,:,:) :: remcvc_io
91:       real(8) , allocatable , dimension(:,:,:,:) :: remlsc_io
92:       real(8) , allocatable , dimension(:,:,:) :: remdrd_io
93: 
94:       real(8) , pointer , dimension(:,:) :: ps0_io , ps1_io , ts0_io ,  &
95:                             &  ts1_io
96:       real(8) , pointer , dimension(:,:,:) :: qb0_io , qb1_io , so0_io ,&
97:                                       & so1_io , tb0_io , tb1_io ,      &
98:                                       & ub0_io , ub1_io , vb0_io ,      &
99:                                       & vb1_io
100:       real(8) , pointer , dimension(:,:) :: ui1_io , ui2_io , uilx_io , &
101:                                    & uil_io , vi1_io , vi2_io ,         &
102:                                    & vilx_io , vil_io
103: 
104:       real(8) , allocatable , dimension(:,:,:,:) :: chemsrc_io
105:       real(8) , allocatable , dimension(:,:,:) :: ddsfc_io , dtrace_io ,&
106:                                    & wdcvc_io , wdlsc_io
107:       real(8) , allocatable , dimension(:,:) :: pptc_io , pptnc_io ,    &
108:                                    & prca2d_io , prnca2d_io
109: 
110:       real(8) , allocatable , dimension(:,:,:,:) :: chia_io , chib_io
111: 
112:       real(8) , pointer , dimension(:,:) :: cldefi_io , f_io , hfx_io , &
113:                                    & htsd_io , ht_io , msfd_io ,        &
114:                                    & msfx_io , psa_io , psb_io ,        &
115:                                    & qfx_io , rainc_io , rainnc_io ,    &
116:                                    & satbrt_io , tga_io , tgbb_io ,     &
117:                                    & tgb_io , uvdrag_io , xlat_io ,     &
118:                                    & xlong_io , zpbl_io
119:       real(8) , pointer , dimension(:,:,:) :: omega_io , qca_io ,       &
120:                               & qcb_io , qva_io , qvb_io , ta_io ,      &
121:                                       & tbase_io , tb_io , ua_io ,      &
122:                                       & ub_io , va_io , vb_io
123: 
124:       real(8) , allocatable , dimension(:,:,:) :: inisrf0
125:       real(8) , allocatable , dimension(:,:,:) :: inisrf_0
126: 
127:       real(8) , allocatable , dimension(:,:) :: var1snd , var1rcv
128:  
129:       real(8) , allocatable , dimension(:,:,:) :: atm0
130:       real(8) , allocatable , dimension(:,:,:) :: atm_0
131:       real(4) , allocatable , dimension(:,:,:) :: bat0
132:       real(4) , allocatable , dimension(:,:,:) :: bat_0
133:       real(8) , allocatable , dimension(:,:,:) :: out0
134:       real(8) , allocatable , dimension(:,:,:) :: out_0
135:       real(4) , allocatable , dimension(:,:,:) :: rad0
136:       real(4) , allocatable , dimension(:,:,:) :: rad_0
137:       real(4) , allocatable , dimension(:,:,:,:) :: sub0
138:       real(4) , allocatable , dimension(:,:,:,:) :: sub_0
139:       real(8) , allocatable , dimension(:,:,:) :: chem0
140:       real(8) , allocatable , dimension(:,:,:) :: chem_0
141: 
142: #ifdef CLM
143:       real(8) , pointer , dimension(:,:) :: sols2d_io , soll2d_io ,     &
144:                    &      solsd2d_io , solld2d_io , aldifl2d_io ,       &
145:                    &      aldirs2d_io , aldirl2d_io , aldifs2d_io ,     &
146:                    &      coszrs2d_io
147: #endif
148: #endif
149: 
150:       contains 
151: !
152: !     This routines allocate all the arrays contained in the module
153: !
<p><a name=allocate_mod_mppio><H3>allocate_mod_mppio</H3></a></p> Click <a href="./callingtree/allocate_mod_mppio_rite.html" TARGET=RITE_PANEL>HERE</a> to see the where allocate_mod_mppio is used.
<hr>
154:       subroutine allocate_mod_mppio
155:       use <a href="./mod_dust.F90.html#mod_dust" TARGET=CENT_PANEL>mod_dust</a> , only : nats
156:       implicit none
157: 
158: #ifdef MPP1
159:       allocate(spacesubm1(nnsg,iym1,jxm1,21))
160:       col2d_io  => spacesubm1(:,:,:,1)
161:       dew2d_io  => spacesubm1(:,:,:,2)
162:       evpa2d_io => spacesubm1(:,:,:,3)
163:       gwet2d_io => spacesubm1(:,:,:,4)
164:       ircp2d_io => spacesubm1(:,:,:,5)
165:       ocld2d_io => spacesubm1(:,:,:,6)
166:       rno2d_io  => spacesubm1(:,:,:,7)
167:       rnos2d_io => spacesubm1(:,:,:,8)
168:       sag2d_io  => spacesubm1(:,:,:,9)
169:       scv2d_io  => spacesubm1(:,:,:,10)
170:       sena2d_io => spacesubm1(:,:,:,11)
171:       sice2d_io => spacesubm1(:,:,:,12)
172:       srw2d_io  => spacesubm1(:,:,:,13)
173:       ssw2d_io  => spacesubm1(:,:,:,14)
174:       swt2d_io  => spacesubm1(:,:,:,15)
175:       taf2d_io  => spacesubm1(:,:,:,16)
176:       text2d_io => spacesubm1(:,:,:,17)
177:       tg2d_io   => spacesubm1(:,:,:,18)
178:       tgb2d_io  => spacesubm1(:,:,:,19)
179:       tlef2d_io => spacesubm1(:,:,:,20)
180:       veg2d1_io => spacesubm1(:,:,:,21)
181:       allocate(spacesub(nnsg,iy,jx,3))
182:       ht1_io     => spacesub(:,:,:,1)
183:       satbrt1_io => spacesub(:,:,:,2)
184:       snowc_io   => spacesub(:,:,:,3)
185:       allocate(spacebat(iym1,jxm1,16))
186:       flw2d_io      => spacebat(:,:,1)
187:       flwd2d_io     => spacebat(:,:,2)
188:       fsw2d_io      => spacebat(:,:,3)
189:       sabv2d_io     => spacebat(:,:,4)
190:       sdelqk2d_io   => spacebat(:,:,5)
191:       sdeltk2d_io   => spacebat(:,:,6)
192:       sfracb2d_io   => spacebat(:,:,7)
193:       sfracs2d_io   => spacebat(:,:,8)
194:       sfracv2d_io   => spacebat(:,:,9)
195:       sinc2d_io     => spacebat(:,:,10)
196:       sol2d_io      => spacebat(:,:,11)
197:       solvd2d_io    => spacebat(:,:,12)
198:       solvs2d_io    => spacebat(:,:,13)
199:       ssw2da_io     => spacebat(:,:,14)
200:       svegfrac2d_io => spacebat(:,:,15)
201:       veg2d_io      => spacebat(:,:,16)
202:       allocate(fbat_io(jxm2,iym2,numbat))
203:       allocate(fsub_io(nnsg,jxm2,iym2,numsub)) 
204:       allocate(frad2d_io(jxm2,iym2,nrad2d))
205:       allocate(frad3d_io(jxm2,iym2,kz,nrad3d))
206:       allocate(cbmf2d_io(iy,jx))
207:       allocate(fcc_io(iy,kz,jx))
208:       allocate(rsheat_io(iy,kz,jx))
209:       allocate(rswat_io(iy,kz,jx))
210:       allocate(absnxt_io(iym1,kz,4,jxm1))
211:       allocate(abstot_io(iym1,kzp1,kz + 1,jxm1))
212:       allocate(emstot_io(iym1,kzp1,jxm1))
213:       allocate(heatrt_io(iym1,kz,jxm1))
214:       allocate(o3prof_io(iym1,kzp1,jxm1))
215:       allocate(dstor_io(iy,jx,nsplit))
216:       allocate(hstor_io(iy,jx,nsplit))
217:       allocate(aerasp_io(iym1,kz,jxm1))
218:       allocate(aerext_io(iym1,kz,jxm1))
219:       allocate(aerssa_io(iym1,kz,jxm1))
220:       allocate(aersrrf_io(iym1,jxm1))
221:       allocate(aertarf_io(iym1,jxm1))
222:       allocate(aertalwrf_io(iym1,jxm1))
223:       allocate(aersrlwrf_io(iym1,jxm1))
224:       allocate(cemtrac_io(iy,jx,ntr))
225:       allocate(cemtr_io(iy,jx,ntr))
226:       allocate(wxaq_io(iy,jx,ntr))
227:       allocate(wxsg_io(iy,jx,ntr))
228:       allocate(dustsotex_io(iy,jx))
229:       allocate(rxsaq1_io(iy,kz,jx,ntr))
230:       allocate(rxsaq2_io(iy,kz,jx,ntr))
231:       allocate(rxsg_io(iy,kz,jx,ntr))
232:       allocate(remcvc_io(iy,kz,jx,ntr))
233:       allocate(remlsc_io(iy,kz,jx,ntr))
234:       allocate(remdrd_io(iy,jx,ntr))
235:       allocate(space2d(iy,jx,4))
236:       ps0_io => space2d(:,:,1)
237:       ps1_io => space2d(:,:,2)
238:       ts0_io => space2d(:,:,3)
239:       ts1_io => space2d(:,:,4)
240:       allocate(space3d(iy,kz,jx,10))
241:       qb0_io => space3d(:,:,:,1)
242:       qb1_io => space3d(:,:,:,2)
243:       so0_io => space3d(:,:,:,3)
244:       so1_io => space3d(:,:,:,4)
245:       tb0_io => space3d(:,:,:,5)
246:       tb1_io => space3d(:,:,:,6)
247:       ub0_io => space3d(:,:,:,7)
248:       ub1_io => space3d(:,:,:,8)
249:       vb0_io => space3d(:,:,:,9)
250:       vb1_io => space3d(:,:,:,10)
251:       allocate(spacev(kz,jx,8))
252:       ui1_io  => spacev(:,:,1)
253:       ui2_io  => spacev(:,:,2)
254:       uilx_io => spacev(:,:,3)
255:       uil_io  => spacev(:,:,4)
256:       vi1_io  => spacev(:,:,5)
257:       vi2_io  => spacev(:,:,6)
258:       vilx_io => spacev(:,:,7)
259:       vil_io  => spacev(:,:,8)
260:       allocate(chemsrc_io(iy,jx,nats,ntr))
261:       allocate(ddsfc_io(iy,jx,ntr))
262:       allocate(dtrace_io(iy,jx,ntr))
263:       allocate(wdcvc_io(iy,jx,ntr))
264:       allocate(wdlsc_io(iy,jx,ntr))
265:       allocate(pptc_io(iym1,jxm1))
266:       allocate(pptnc_io(iym1,jxm1))
267:       allocate(prca2d_io(iym1,jxm1))
268:       allocate(prnca2d_io(iym1,jxm1))
269:       allocate(chia_io(iy,kz,jx,ntr))
270:       allocate(chib_io(iy,kz,jx,ntr))
271:       allocate(spacesurf(iy,jx,20))
272:       cldefi_io => spacesurf(:,:,1)
273:       f_io      => spacesurf(:,:,2)
274:       hfx_io    => spacesurf(:,:,3)
275:       htsd_io   => spacesurf(:,:,4)
276:       ht_io     => spacesurf(:,:,5)
277:       msfd_io   => spacesurf(:,:,6)
278:       msfx_io   => spacesurf(:,:,7)
279:       psa_io    => spacesurf(:,:,8)
280:       psb_io    => spacesurf(:,:,9)
281:       qfx_io    => spacesurf(:,:,10)
282:       rainc_io  => spacesurf(:,:,11)
283:       rainnc_io => spacesurf(:,:,12)
284:       satbrt_io => spacesurf(:,:,13)
285:       tga_io    => spacesurf(:,:,14)
286:       tgbb_io   => spacesurf(:,:,15)
287:       tgb_io    => spacesurf(:,:,16)
288:       uvdrag_io => spacesurf(:,:,17)
289:       xlat_io   => spacesurf(:,:,18)
290:       xlong_io  => spacesurf(:,:,19)
291:       zpbl_io   => spacesurf(:,:,20)
292:       allocate(spaceair(iy,kz,jx,12))
293:       omega_io => spaceair(:,:,:,1)
294:       qca_io   => spaceair(:,:,:,2)
295:       qcb_io   => spaceair(:,:,:,3)
296:       qva_io   => spaceair(:,:,:,4)
297:       qvb_io   => spaceair(:,:,:,5)
298:       ta_io    => spaceair(:,:,:,6)
299:       tbase_io => spaceair(:,:,:,7)
300:       tb_io    => spaceair(:,:,:,8)
301:       ua_io    => spaceair(:,:,:,9)
302:       ub_io    => spaceair(:,:,:,10)
303:       va_io    => spaceair(:,:,:,11)
304:       vb_io    => spaceair(:,:,:,12)
305:       allocate(inisrf0(iy,nnsg*3+8,jxp))
306:       allocate(inisrf_0(iy,nnsg*3+8,jx))
307:       allocate(var1snd(kz,8))
308:       allocate(var1rcv(kz,8))
309:       allocate(atm0(iy,kz*6+3+nnsg*4,jxp))
310:       allocate(atm_0(iy,kz*6+3+nnsg*4,jx))
311:       allocate(bat0(iym2,numbat,jxp))
312:       allocate(bat_0(iym2,numbat,jx))
313:       allocate(out0(iy,3,jxp))
314:       allocate(out_0(iy,3,jx))
315:       allocate(rad0(iym2,nrad3d*kz+nrad2d,jxp))
316:       allocate(rad_0(iym2,nrad3d*kz+nrad2d,jx))
317:       allocate(sub0(iym2,nnsg,numsub,jxp))
318:       allocate(sub_0(iym2,nnsg,numsub,jx))
319:       allocate(chem0(iy,ntr*kz+kz*3+ntr*7+5,jxp))
320:       allocate(chem_0(iy,ntr*kz+kz*3+ntr*7+5,jx))
321: #ifdef CLM
322:       allocate(spaceclm(iym1,jxm1,9))
323:       sols2d_io   => spaceclm(:,:,1)
324:       soll2d_io   => spaceclm(:,:,2)
325:       solsd2d_io  => spaceclm(:,:,3)
326:       solld2d_io  => spaceclm(:,:,4)
327:       aldifl2d_io => spaceclm(:,:,5)
328:       aldirs2d_io => spaceclm(:,:,6)
329:       aldirl2d_io => spaceclm(:,:,7)
330:       aldifs2d_io => spaceclm(:,:,8)
331:       coszrs2d_io => spaceclm(:,:,9)
332: #endif       
333: #endif       
334:       end subroutine allocate_mod_mppio
335:       
336:       end module mod_mppio
</PRE>

<HR>

</BODY>
</HTML>
