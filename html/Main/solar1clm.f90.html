<HTML>

<HEAD>
<TITLE>solar1clm.f90</TITLE>
</HEAD>

<BODY background="back_granite.gif">
<FONT COLOR="#000000" FACE="Times">
<H1 ALIGN=CENTER>solar1clm.f90</H1>
<HR>
<H2 ALIGN=CENTER>solar1clm.f90</H2>
<HR>
</FONT>

<HR>

<PRE>
1: !::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
2: !
3: !    This file is part of ICTP RegCM.
4: !
5: !    ICTP RegCM is free software: you can redistribute it and/or modify
6: !    it under the terms of the GNU General Public License as published by
7: !    the Free Software Foundation, either version 3 of the License, or
8: !    (at your option) any later version.
9: !
10: !    ICTP RegCM is distributed in the hope that it will be useful,
11: !    but WITHOUT ANY WARRANTY; without even the implied warranty of
12: !    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
13: !    GNU General Public License for more details.
14: !
15: !    You should have received a copy of the GNU General Public License
16: !    along with ICTP RegCM.  If not, see <http://www.gnu.org/licenses/>.
17: !
18: !::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
19: 
<p><a name=solar1clm><H3>solar1clm</H3></a></p> Click <a href="./callingtree/solar1clm_rite.html" TARGET=RITE_PANEL>HERE</a> to see the where solar1clm is used.
<hr>
20:       subroutine solar1clm(xtime)
21: 
22: !cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
23: !                                                                     c
24: !     This subroutine calls clm routines to compute the following     c
25: !     orbital variables based on julian date:                         c
26: !                                                                     c
27: !     eccen   : orbital eccentricity                                  c
28: !     obliq   : obliquity in degrees                                  c
29: !     obliqr  : obliquity in radians                                  c
30: !     mvelp   : moving vernal equinox long                            c
31: !     mvelpp  : moving vernal equinox long of perihelion plus pi(rad) c
32: !     lambm0  : mean long of perihelion at vernal equinox (rad)       c
33: !     delta   : solar declination angle in rad                        c
34: !     eccf    : Earth-sun distance factor ((1/r)**2)                  c
35: !                                                                     c
36: !     Input Variables:                                                c
37: !     xtime   : forecast time in minutes.                             c
38: !                                                                     c
39: !cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
40: 
41: !
42:       use <a href="#" TARGET=CENT_PANEL>shr_orb_mod</a>
43:       use <a href="#" TARGET=CENT_PANEL>clm_varsur</a> ,  only : numdays
<p><a name=only : r8><H3>only : r8</H3></a></p> Click <a href="./callingtree/only : r8_rite.html" TARGET=RITE_PANEL>HERE</a> to see the where only : r8 is used.
<hr>
44:       use shr_kind_mod , only : r8 => <a href="#" TARGET=CENT_PANEL>shr_kind_r8</a>
45: !
46:       use <a href="./mod_clm.F90.html#mod_clm" TARGET=CENT_PANEL>mod_clm</a> , only : r2ceccen , r2cobliqr , r2clambm0 ,           &
47:              &             r2cmvelpp , r2ceccf
48:       use <a href="./mod_message.F90.html#mod_message" TARGET=CENT_PANEL>mod_message</a> , only : aline , say
49:       use <a href="./mod_date.F90.html#mod_date" TARGET=CENT_PANEL>mod_date</a> , only : declin , julday , gmt , nnnnnn , nstrt0 ,   &
50:              &              idate1
51:       use <a href="./mod_constants.F90.html#mod_constants" TARGET=CENT_PANEL>mod_constants</a> , only : degrad , dayspy
52: 
53:       implicit none
54: !
55: ! Dummy arguments
56: !
57:       real(8) :: xtime
58:       intent (in) xtime
59: !
60: ! Local variables
61: !
62: !----------------------------------------------------------------------
63: !
64: !     local variables for orbital params
65: !
66: ! obliq     : obliquity in degrees
67: ! mvelp     : moving vernal equinox long
68: ! delta     : solar decl in radians
69: ! iyear_ad  : Year to calculate orbit for
70: ! log_print : Flags print of status/error
71: ! decdeg    : solar decl in degrees
72: !
73: !----------------------------------------------------------------------
74: !
75:       real(8) :: calday , decdeg
76:       real(r8) :: delta , mvelp , obliq
77:       integer :: iyear_ad
78:       logical :: log_print
79: !
80:       
81:       log_print = .false.
82: 
83:       iyear_ad = idate1/1000000
84:       numdays = dayspy
85:  
86: !     Get eccen,obliq,mvelp,obliqr,lambm0,mvelpp
87:       call <a href="#" TARGET=CENT_PANEL>shr_orb_params</a>(iyear_ad,r2ceccen,obliq,mvelp,r2cobliqr,      &
88:                         & r2clambm0,r2cmvelpp,log_print)
89:  
90:       calday = dble(julday) + (nnnnnn-nstrt0)/4. + (xtime/60.+gmt)/24.
91:  
92: !     Get delta,eccf
93:       call <a href="#" TARGET=CENT_PANEL>shr_orb_decl</a>(calday,r2ceccen,r2cmvelpp,r2clambm0,r2cobliqr,  &
94:                       & delta,r2ceccf)
95:  
96: !     convert delta to degrees
97:       declin = delta
98:       decdeg = declin/degrad
99:  
100: !     abt rcm below
101:       write (aline, 99001) decdeg
102:       call <a href="./mod_message.F90.html#say" TARGET=CENT_PANEL>say</a>
103: 99001 format (11x,'*** solar declination angle = ',f6.2,' degrees.')
104:  
105:       end subroutine solar1clm
</PRE>

<HR>

</BODY>
</HTML>
