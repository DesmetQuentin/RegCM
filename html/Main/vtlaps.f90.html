<HTML>

<HEAD>
<TITLE>vtlaps.f90</TITLE>
</HEAD>

<BODY background="back_granite.gif">
<FONT COLOR="#000000" FACE="Times">
<H1 ALIGN=CENTER>vtlaps.f90</H1>
<HR>
<H2 ALIGN=CENTER>vtlaps.f90</H2>
<HR>
</FONT>

<HR>

<PRE>
1: !::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
2: !
3: !    This file is part of ICTP RegCM.
4: !
5: !    ICTP RegCM is free software: you can redistribute it and/or modify
6: !    it under the terms of the GNU General Public License as published by
7: !    the Free Software Foundation, either version 3 of the License, or
8: !    (at your option) any later version.
9: !
10: !    ICTP RegCM is distributed in the hope that it will be useful,
11: !    but WITHOUT ANY WARRANTY; without even the implied warranty of
12: !    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
13: !    GNU General Public License for more details.
14: !
15: !    You should have received a copy of the GNU General Public License
16: !    along with ICTP RegCM.  If not, see <http://www.gnu.org/licenses/>.
17: !
18: !::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
19:  
<p><a name=vtlaps><H3>vtlaps</H3></a></p> Click <a href="./callingtree/vtlaps_rite.html" TARGET=RITE_PANEL>HERE</a> to see the where vtlaps is used.
<hr>
20:       subroutine vtlaps(t,sigma,pt,pd,nk)
21: 
22:       use <a href="./mod_constants.F90.html#mod_constants" TARGET=CENT_PANEL>mod_constants</a> , only : rgti , stdp , stdt , lrate , rgas
23:       implicit none
24: !
25: ! PARAMETER definitions
26: !
27:       real(8) , parameter :: tstrat = 218.15 , zstrat = 10769
28:       real(8) :: p0
29: !
30: ! Dummy arguments
31: !
32:       integer :: nk
33:       real(8) :: pd , pt
34:       real(8) , dimension(nk) :: sigma , t
35:       intent (in) nk , pd , pt , sigma
36:       intent (inout) t
37: !
38: ! Local variables
39: !
40:       real(8) :: fac , p , z
41:       integer :: k
42: !
43: !  this routine computes the temperature corresponding to a u. s.
44: !  standard atmosphere (see text by hess). units of p are cb.
45: !
46:       p0 = stdp/1000.D0
47:       fac = rgas*lrate*rgti
48:       do k = 1 , nk
49:         p = sigma(k)*pd + pt
50:         t(k) = stdt*((p/p0)**fac)
51:         z = (stdt-t(k))/lrate
52:         if ( z.gt.zstrat ) t(k) = tstrat
53:       end do
54: !
55:       end subroutine vtlaps
</PRE>

<HR>

</BODY>
</HTML>
