<HTML>

<HEAD>
<TITLE>solar1.f90</TITLE>
</HEAD>

<BODY background="back_granite.gif">
<FONT COLOR="#000000" FACE="Times">
<H1 ALIGN=CENTER>solar1.f90</H1>
<HR>
<H2 ALIGN=CENTER>solar1.f90</H2>
<HR>
</FONT>

<HR>

<PRE>
1: !::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
2: !
3: !    This file is part of ICTP RegCM.
4: !
5: !    ICTP RegCM is free software: you can redistribute it and/or modify
6: !    it under the terms of the GNU General Public License as published by
7: !    the Free Software Foundation, either version 3 of the License, or
8: !    (at your option) any later version.
9: !
10: !    ICTP RegCM is distributed in the hope that it will be useful,
11: !    but WITHOUT ANY WARRANTY; without even the implied warranty of
12: !    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
13: !    GNU General Public License for more details.
14: !
15: !    You should have received a copy of the GNU General Public License
16: !    along with ICTP RegCM.  If not, see <http://www.gnu.org/licenses/>.
17: !
18: !::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
19:  
<p><a name=solar1><H3>solar1</H3></a></p> Click <a href="./callingtree/solar1_rite.html" TARGET=RITE_PANEL>HERE</a> to see the where solar1 is used.
<hr>
20:       subroutine solar1(xtime)
21: 
22: !cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
23: !                                                                     c
24: !     this subroutine computes the solar declination angle from the   c
25: !     julian date.                                                    c
26: !                                                                     c
27: !     xtime  : forecast time in minutes.                              c
28: !                                                                     c
29: !cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
30:       use <a href="./mod_message.F90.html#mod_message" TARGET=CENT_PANEL>mod_message</a>
31:       use <a href="./mod_date.F90.html#mod_date" TARGET=CENT_PANEL>mod_date</a> , only : declin , julday , gmt , nnnnnn , nstrt0
32:       use <a href="./mod_constants.F90.html#mod_constants" TARGET=CENT_PANEL>mod_constants</a> , only : mathpi , degrad , dayspy
33:       implicit none
34: !
35: ! Dummy arguments
36: !
37:       real(8) :: xtime
38:       intent (in) xtime
39: !
40: ! Local variables
41: !
42:       real(8) :: calday , decdeg , delta , theta
43: !
44: !----------------------------------------------------------------------
45: !
46: !-----obecl : obliquity = 23.5 degree.
47: !
48: !KN   obecl=23.5*degrad
49: !KN   sinob=dsin(obecl)
50: !
51: !-----calculate longitude of the sun from vernal equinox:
52: !
53: !KN   julian=julday+nint((xtime/60.+gmt)/24.)
54: !KN   if (julian .ge. 81) xlong=dpd*dble(julian-81)
55: !KN   if (julian .lt. 81) xlong=dpd*dble(julian+284)
56: !KN   xlong=xlong*degrad
57: !KN   arg=sinob*dsin(xlong)
58: !KN   declin=dasin(arg)
59:  
60: !KN   added below
61: !KN   to take the earth's orbital eccentricity into consideration
62: !
63:       calday = dble(julday) + (nnnnnn-nstrt0)/4. + (xtime/60.+gmt)/24.
64:       theta = 2.*mathpi*calday/dayspy
65: !
66: !     Solar declination in radians:
67: !
68:       delta = .006918 - .399912*dcos(theta) + .070257*dsin(theta)       &
69:             & - .006758*dcos(2.*theta) + .000907*dsin(2.*theta)         &
70:             & - .002697*dcos(3.*theta) + .001480*dsin(3.*theta)
71: !
72:       declin = delta
73: !
74: !KN   added above
75:  
76:       decdeg = declin/degrad
77: !
78:       write (aline, 99001) decdeg
79:       call <a href="./mod_message.F90.html#say" TARGET=CENT_PANEL>say</a>
80: 99001 format (11x,'*** solar declination angle = ',f6.2,' degrees.')
81: !
82:       end subroutine solar1
</PRE>

<HR>

</BODY>
</HTML>
