<HTML>

<HEAD>
<TITLE>cumtran.F90</TITLE>
</HEAD>

<BODY background="back_granite.gif">
<FONT COLOR="#000000" FACE="Times">
<H1 ALIGN=CENTER>cumtran.F90</H1>
<HR>
<H2 ALIGN=CENTER>cumtran.F90</H2>
<HR>
</FONT>

<HR>

<PRE>
1: !::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
2: !
3: !    This file is part of ICTP RegCM.
4: !
5: !    ICTP RegCM is free software: you can redistribute it and/or modify
6: !    it under the terms of the GNU General Public License as published by
7: !    the Free Software Foundation, either version 3 of the License, or
8: !    (at your option) any later version.
9: !
10: !    ICTP RegCM is distributed in the hope that it will be useful,
11: !    but WITHOUT ANY WARRANTY; without even the implied warranty of
12: !    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
13: !    GNU General Public License for more details.
14: !
15: !    You should have received a copy of the GNU General Public License
16: !    along with ICTP RegCM.  If not, see <http://www.gnu.org/licenses/>.
17: !
18: !::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
19:  
<p><a name=cumtran><H3>cumtran</H3></a></p> Click <a href="./callingtree/cumtran_rite.html" TARGET=RITE_PANEL>HERE</a> to see the where cumtran is used.
<hr>
20:       subroutine cumtran
21: 
22:       use <a href="./mod_dynparam.F90.html#mod_dynparam" TARGET=CENT_PANEL>mod_dynparam</a>
23:       use <a href="./mod_trachem.F90.html#mod_trachem" TARGET=CENT_PANEL>mod_trachem</a>
24:       use <a href="./mod_mainchem.F90.html#mod_mainchem" TARGET=CENT_PANEL>mod_mainchem</a>
25:       use <a href="./mod_param3.f90.html#mod_param3" TARGET=CENT_PANEL>mod_param3</a> , only : dsigma
26:       implicit none
27: !
28: ! Local variables
29: !
30:       real(8) :: chiabar , chibbar , cumfrc , deltas
31:       integer :: i , j , k , kcumtop , n
32: !
33: !hy   the well-mixing only over cumulus cloud fraction (assuming 0.3)
34: !     add the well-mixing fraction in dt step (5%) - only updraft
35: !hy   cumfrc = 0.3
36:       cumfrc = 0.015
37:  
38:       do n = 1 , ntr
39: #ifdef MPP1
40:         do j = jbegin , jendx
41: #else
42:         do j = 2 , jxm1
43: #endif
44:           do i = 2 , iym1
45:             if ( icumtop(i,j).gt.0 ) then
46:               deltas = 0.
47:               chiabar = 0.
48:               chibbar = 0.
49:               kcumtop = max0(icumtop(i,j),4)
50:               do k = kcumtop , kz
51:                 deltas = deltas + dsigma(k)
52:                 chiabar = chiabar + chia(i,k,j,n)*dsigma(k)
53:                 chibbar = chibbar + chib(i,k,j,n)*dsigma(k)
54:               end do
55: !?            do 95 k=icumtop(i,j),kz      ! yhuang, 12/98
56: !qhy
57:               do k = kcumtop , kz
58:                 chia(i,k,j,n) = chia(i,k,j,n)*(1.-cumfrc)               &
59:                               & + cumfrc*chiabar/deltas
60:                 chib(i,k,j,n) = chib(i,k,j,n)*(1.-cumfrc)               &
61:                               & + cumfrc*chibbar/deltas
62:               end do
63:             end if
64:           end do
65:         end do
66:       end do
67:       end subroutine cumtran
</PRE>

<HR>

</BODY>
</HTML>
