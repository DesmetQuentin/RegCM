<HTML>

<HEAD>
<TITLE>mod_o3blk.F90</TITLE>
</HEAD>

<BODY background="back_granite.gif">
<FONT COLOR="#000000" FACE="Times">
<H1 ALIGN=CENTER>mod_o3blk.F90</H1>
<HR>
<H2 ALIGN=CENTER>mod_o3blk.F90</H2>
<HR>
</FONT>

<HR>

<PRE>
1: !::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
2: !
3: !    This file is part of ICTP RegCM.
4: !
5: !    ICTP RegCM is free software: you can redistribute it and/or modify
6: !    it under the terms of the GNU General Public License as published by
7: !    the Free Software Foundation, either version 3 of the License, or
8: !    (at your option) any later version.
9: !
10: !    ICTP RegCM is distributed in the hope that it will be useful,
11: !    but WITHOUT ANY WARRANTY; without even the implied warranty of
12: !    MDRCHANTABILITY or FITNDSS FOR A PARTICULAR PURPOSD.  See the
13: !    GNU General Public License for more details.
14: !
15: !    You should have received a copy of the GNU General Public License
16: !    along with ICTP RegCM.  If not, see <http://www.gnu.org/licenses/>.
17: !
18: !::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
19: 
<p><a name=mod_o3blk><H3>mod_o3blk</H3></a></p>20:       module mod_o3blk
21:       use <a href="./mod_dynparam.F90.html#mod_dynparam" TARGET=CENT_PANEL>mod_dynparam</a>
22:       implicit none
23:       real(8) , dimension(31) :: o3ann , o3sum , o3win , o3wrk , ppann ,&
24:                                & ppsum , ppwin , ppwrk
25:       real(8) , dimension(32) :: ppwrkh
26:       real(8) , allocatable , dimension(:) :: prlevh
27:       private :: o3ann , o3sum , o3win , o3wrk , ppann , ppsum , ppwin ,&
28:               &  ppwrk , ppwrkh , prlevh
29: !
30:       data o3sum/5.297D-8 , 5.852D-8 , 6.579D-8 , 7.505D-8 , 8.577D-8 , &
31:          & 9.895D-8 , 1.175D-7 , 1.399D-7 , 1.677D-7 , 2.003D-7 ,       &
32:          & 2.571D-7 , 3.325D-7 , 4.438D-7 , 6.255D-7 , 8.168D-7 ,       &
33:          & 1.036D-6 , 1.366D-6 , 1.855D-6 , 2.514D-6 , 3.240D-6 ,       &
34:          & 4.033D-6 , 4.854D-6 , 5.517D-6 , 6.089D-6 , 6.689D-6 ,       &
35:          & 1.106D-5 , 1.462D-5 , 1.321D-5 , 9.856D-6 , 5.960D-6 ,       &
36:          & 5.960D-6/
37:       data ppsum/955.890 , 850.532 , 754.599 , 667.742 , 589.841 ,      &
38:          & 519.421 , 455.480 , 398.085 , 347.171 , 301.735 , 261.310 ,  &
39:          & 225.360 , 193.419 , 165.490 , 141.032 , 120.125 , 102.689 ,  &
40:          & 87.829 , 75.123 , 64.306 , 55.086 , 47.209 , 40.535 ,        &
41:          & 34.795 , 29.865 , 19.122 , 9.277 , 4.660 , 2.421 , 1.294 ,   &
42:          & 0.647/
43: !
44:       data o3win/4.629D-8 , 4.686D-8 , 5.017D-8 , 5.613D-8 , 6.871D-8 , &
45:          & 8.751D-8 , 1.138D-7 , 1.516D-7 , 2.161D-7 , 3.264D-7 ,       &
46:          & 4.968D-7 , 7.338D-7 , 1.017D-6 , 1.308D-6 , 1.625D-6 ,       &
47:          & 2.011D-6 , 2.516D-6 , 3.130D-6 , 3.840D-6 , 4.703D-6 ,       &
48:          & 5.486D-6 , 6.289D-6 , 6.993D-6 , 7.494D-6 , 8.197D-6 ,       &
49:          & 9.632D-6 , 1.113D-5 , 1.146D-5 , 9.389D-6 , 6.135D-6 ,       &
50:          & 6.135D-6/
51:       data ppwin/955.747 , 841.783 , 740.199 , 649.538 , 568.404 ,      &
52:          & 495.815 , 431.069 , 373.464 , 322.354 , 277.190 , 237.635 ,  &
53:          & 203.433 , 174.070 , 148.949 , 127.408 , 108.915 , 93.114 ,   &
54:          & 79.551 , 67.940 , 58.072 , 49.593 , 42.318 , 36.138 ,        &
55:          & 30.907 , 26.362 , 16.423 , 7.583 , 3.620 , 1.807 , 0.938 ,   &
56:          & 0.469/
57: 
58:       contains
59: 
<p><a name=allocate_mod_o3blk><H3>allocate_mod_o3blk</H3></a></p> Click <a href="./callingtree/allocate_mod_o3blk_rite.html" TARGET=RITE_PANEL>HERE</a> to see the where allocate_mod_o3blk is used.
<hr>
60:       subroutine allocate_mod_o3blk
61:         implicit none
62:         allocate(prlevh(kzp2))
63:       end subroutine allocate_mod_o3blk
64: !
65: !----------------------------------------------------------------------
66: !
<p><a name=o3data><H3>o3data</H3></a></p> Click <a href="./callingtree/o3data_rite.html" TARGET=RITE_PANEL>HERE</a> to see the where o3data is used.
<hr>
67:       subroutine o3data
68: !
69:       use <a href="./mod_dynparam.F90.html#mod_dynparam" TARGET=CENT_PANEL>mod_dynparam</a>
70:       use <a href="./mod_param3.f90.html#mod_param3" TARGET=CENT_PANEL>mod_param3</a> , only : r8pt , sigma
71:       use <a href="./mod_main.F90.html#mod_main" TARGET=CENT_PANEL>mod_main</a>
72:       use <a href="./mod_rad.F90.html#mod_rad" TARGET=CENT_PANEL>mod_rad</a>
73:       implicit none
74: !
75: ! Local variables
76: !
77:       integer :: i , j , jj , k , kj , klevp1
78:       real(8) :: pb1 , pb2 , pt1 , pt2
79: !
80:       do k = 1 , 31
81:         ppann(k) = ppsum(k)
82:       end do
83:       o3ann(1) = 0.5*(o3sum(1)+o3win(1))
84: !
85:       do k = 2 , 31
86:         o3ann(k) = o3win(k-1) + (o3win(k)-o3win(k-1))                   &
87:                  & /(ppwin(k)-ppwin(k-1))*(ppsum(k)-ppwin(k-1))
88:       end do
89:       do k = 2 , 31
90:         o3ann(k) = 0.5*(o3ann(k)+o3sum(k))
91:       end do
92:       do k = 1 , 31
93:         o3wrk(k) = o3ann(k)
94:         ppwrk(k) = ppann(k)
95:       end do
96: !
97: !     calculate half pressure levels for model and data levels
98: !
99:       klevp1 = kzp1
100: !
101: #ifdef MPP1
102:       do j = 1 , jendx
103: #else
104:       do j = 1 , jxm1
105: #endif
106:         do i = 1 , iym1
107:           do k = klevp1 , 1 , -1
108:             kj = klevp1 - k + 1
109:             prlevh(kj) = (sigma(k)*psb(i,j)+r8pt)*10.
110:           end do
111:           ppwrkh(1) = 1100.
112:           do k = 2 , 31
113:             ppwrkh(k) = (ppwrk(k)+ppwrk(k-1))/2.
114:           end do
115:           ppwrkh(32) = 0.
116:           do k = 1 , kz
117:             o3prof(i,k,j) = 0.
118:             do jj = 1 , 31
119:               if ( (-(prlevh(k)-ppwrkh(jj))).ge.0. ) then
120:                 pb1 = 0.
121:               else
122:                 pb1 = prlevh(k) - ppwrkh(jj)
123:               end if
124:               if ( (-(prlevh(k)-ppwrkh(jj+1))).ge.0. ) then
125:                 pb2 = 0.
126:               else
127:                 pb2 = prlevh(k) - ppwrkh(jj+1)
128:               end if
129:               if ( (-(prlevh(k+1)-ppwrkh(jj))).ge.0. ) then
130:                 pt1 = 0.
131:               else
132:                 pt1 = prlevh(k+1) - ppwrkh(jj)
133:               end if
134:               if ( (-(prlevh(k+1)-ppwrkh(jj+1))).ge.0. ) then
135:                 pt2 = 0.
136:               else
137:                 pt2 = prlevh(k+1) - ppwrkh(jj+1)
138:               end if
139:               o3prof(i,k,j) = o3prof(i,k,j) + (pb2-pb1-pt2+pt1)         &
140:                             & *o3wrk(jj)
141:             end do
142:             o3prof(i,k,j) = o3prof(i,k,j)/(prlevh(k)-prlevh(k+1))
143:           end do
144:         end do
145:       end do
146: !
147:       end subroutine o3data
148:       end module mod_o3blk
</PRE>

<HR>

</BODY>
</HTML>
