<HTML>

<HEAD>
<TITLE>radoz2.f90</TITLE>
</HEAD>

<BODY background="back_granite.gif">
<FONT COLOR="#000000" FACE="Times">
<H1 ALIGN=CENTER>radoz2.f90</H1>
<HR>
<H2 ALIGN=CENTER>radoz2.f90</H2>
<HR>
</FONT>

<HR>

<PRE>
1: !::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
2: !
3: !    This file is part of ICTP RegCM.
4: !
5: !    ICTP RegCM is free software: you can redistribute it and/or modify
6: !    it under the terms of the GNU General Public License as published by
7: !    the Free Software Foundation, either version 3 of the License, or
8: !    (at your option) any later version.
9: !
10: !    ICTP RegCM is distributed in the hope that it will be useful,
11: !    but WITHOUT ANY WARRANTY; without even the implied warranty of
12: !    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
13: !    GNU General Public License for more details.
14: !
15: !    You should have received a copy of the GNU General Public License
16: !    along with ICTP RegCM.  If not, see <http://www.gnu.org/licenses/>.
17: !
18: !::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
19:  
<p><a name=radoz2><H3>radoz2</H3></a></p> Click <a href="./callingtree/radoz2_rite.html" TARGET=RITE_PANEL>HERE</a> to see the where radoz2 is used.
<hr>
20:       subroutine radoz2(o3vmr,pint,plol,plos)
21: 
22: !-----------------------------------------------------------------------
23: !
24: ! Computes the path length integrals to the model interfaces given the
25: ! ozone volume mixing ratio
26: !
27: !---------------------------Code history--------------------------------
28: !
29: ! Original version:     CCM1
30: ! Standardized:         J. Rosinski, June 1992
31: ! Reviewed:             J. Kiehl, B. Briegleb, August 1992
32: ! Mixing ratio version: Bruce Biegleb, September 1992
33: !
34: !-----------------------------------------------------------------------
35: !
36:       use <a href="./mod_dynparam.F90.html#mod_dynparam" TARGET=CENT_PANEL>mod_dynparam</a>
37:       use <a href="./mod_comozp.f90.html#mod_comozp" TARGET=CENT_PANEL>mod_comozp</a>
38:       implicit none
39: !
40: !------------------------------Input arguments--------------------------
41: !
42: ! o3vmr   - ozone volume mixing ratio
43: ! pint    - Model interface pressures
44: !
45: !----------------------------Output arguments---------------------------
46: !
47: ! plol    - Ozone prs weighted path length (cm)
48: ! plos    - Ozone path length (cm)
49: !
50: !
51: ! Dummy arguments
52: !
53:       real(8) , dimension(iym1,kz) :: o3vmr
54:       real(8) , dimension(iym1,kzp1) :: pint , plol , plos
55:       intent (in) o3vmr , pint
56:       intent (inout) plol , plos
57: !
58: !---------------------------Local workspace-----------------------------
59: !
60: ! i       - longitude index
61: ! k       - level index
62: !
63: !-----------------------------------------------------------------------
64: !
65: ! Local variables
66: !
67:       integer :: i , k
68: !
69: !     Evaluate the ozone path length integrals to interfaces;
70: !     factors of .1 and .01 to convert pressures from cgs to mks:
71: !
72: !     Bug fix, 24 May 1996:  the 0.5 and 0.25 factors removed.
73: !
74:       do i = 1 , iym1
75:         plos(i,1) = 0.1*cplos*o3vmr(i,1)*pint(i,1)
76:         plol(i,1) = 0.01*cplol*o3vmr(i,1)*pint(i,1)*pint(i,1)
77:       end do
78:       do k = 2 , kzp1
79:         do i = 1 , iym1
80:           plos(i,k) = plos(i,k-1) + 0.1*cplos*o3vmr(i,k-1)              &
81:                     & *(pint(i,k)-pint(i,k-1))
82:           plol(i,k) = plol(i,k-1) + 0.01*cplol*o3vmr(i,k-1)             &
83:                     & *(pint(i,k)*pint(i,k)-pint(i,k-1)*pint(i,k-1))
84:         end do
85:       end do
86: !
87:       end subroutine radoz2
</PRE>

<HR>

</BODY>
</HTML>
