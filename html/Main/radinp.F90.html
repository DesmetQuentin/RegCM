<HTML>

<HEAD>
<TITLE>radinp.F90</TITLE>
</HEAD>

<BODY background="back_granite.gif">
<FONT COLOR="#000000" FACE="Times">
<H1 ALIGN=CENTER>radinp.F90</H1>
<HR>
<H2 ALIGN=CENTER>radinp.F90</H2>
<HR>
</FONT>

<HR>

<PRE>
1: !::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
2: !
3: !    This file is part of ICTP RegCM.
4: !
5: !    ICTP RegCM is free software: you can redistribute it and/or modify
6: !    it under the terms of the GNU General Public License as published by
7: !    the Free Software Foundation, either version 3 of the License, or
8: !    (at your option) any later version.
9: !
10: !    ICTP RegCM is distributed in the hope that it will be useful,
11: !    but WITHOUT ANY WARRANTY; without even the implied warranty of
12: !    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
13: !    GNU General Public License for more details.
14: !
15: !    You should have received a copy of the GNU General Public License
16: !    along with ICTP RegCM.  If not, see <http://www.gnu.org/licenses/>.
17: !
18: !::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
19:  
<p><a name=radinp><H3>radinp</H3></a></p> Click <a href="./callingtree/radinp_rite.html" TARGET=RITE_PANEL>HERE</a> to see the where radinp is used.
<hr>
20:       subroutine radinp(pmid,pint,h2ommr,cld,o3vmr,pmidrd,pintrd,plco2, &
21:                       & plh2o,tclrsf,eccf,o3mmr)
22: 
23: !-----------------------------------------------------------------------
24: !
25: ! Set latitude and time dependent arrays for input to solar
26: ! and longwave radiation.
27: !
28: ! Convert model pressures to cgs, compute path length arrays needed for the
29: ! longwave radiation, and compute ozone mixing ratio, needed for the solar
30: ! radiation.
31: !
32: !---------------------------Code history--------------------------------
33: !
34: ! Original version:  CCM1
35: ! Standardized:      J. Rosinski, June 1992
36: ! Reviewed:          J. Kiehl, B. Briegleb, August 1992
37: !
38: !-----------------------------------------------------------------------
39: !
40:       use <a href="./mod_dynparam.F90.html#mod_dynparam" TARGET=CENT_PANEL>mod_dynparam</a>
41:       use <a href="./mod_date.F90.html#mod_date" TARGET=CENT_PANEL>mod_date</a>
42:       use <a href="./mod_constants.F90.html#mod_constants" TARGET=CENT_PANEL>mod_constants</a> , only : gtigts , twopi , dayspy , rgsslp , sslp
43:       use <a href="./mod_constants.F90.html#mod_constants" TARGET=CENT_PANEL>mod_constants</a> , only : amd , amo , amco2
44:       use <a href="./mod_crdcae.f90.html#mod_crdcae" TARGET=CENT_PANEL>mod_crdcae</a> , only : co2vmr
45: #ifdef CLM
46:       use <a href="./mod_clm.F90.html#mod_clm" TARGET=CENT_PANEL>mod_clm</a>
47: #endif
48:       implicit none
49: !
50: ! Dummy arguments
51: !
52:       real(8) :: eccf
53:       real(8) , dimension(iym1,kzp1) :: cld , pint , pintrd , plco2 ,   &
54:            & plh2o , tclrsf
55:       real(8) , dimension(iym1,kz) :: h2ommr , o3mmr , o3vmr , pmid ,   &
56:            & pmidrd
57:       intent (in) cld , h2ommr , o3vmr , pint , pmid
58:       intent (out) eccf , o3mmr , plco2 , pmidrd
59:       intent (inout) pintrd , plh2o , tclrsf
60: !
61: ! Local variables
62: !
63: #ifndef CLM
64:       real(8) :: theta
65: #endif
66:       real(8) :: cpwpl , vmmr
67:       integer :: i , k
68: !
69: !------------------------------Arguments--------------------------------
70: !
71: !     Input arguments
72: !
73: ! pmid    - Pressure at model mid-levels (pascals)
74: ! pint    - Pressure at model interfaces (pascals)
75: ! h2ommr  - H2o mass mixing ratio
76: ! cld     - Fractional cloud cover
77: ! o3vmr   - ozone volume mixing ratio
78: !
79: !     Output arguments
80: !
81: ! pmidrd  - Pressure at mid-levels (dynes/cm*2)
82: ! pintrd  - Pressure at interfaces (dynes/cm*2)
83: ! plco2   - Vert. pth lngth of co2 (prs-weighted)
84: ! plh2o   - Vert. pth lngth h2o vap.(prs-weighted)
85: ! tclrsf  - Product of clr-sky fractions from top of atmosphere to level.
86: ! eccf    - Earth-sun distance factor
87: ! o3mmr   - Ozone mass mixing ratio
88: !
89: !---------------------------Local variables-----------------------------
90: !
91: ! i       - Longitude loop index
92: ! k       - Vertical loop index
93: ! theta   - Earth orbit seasonal angle in radians
94: ! cpwpl   - Const in co2 mixing ratio to path length conversn
95: ! vmmr    - Ozone volume mixing ratio
96: !
97: !-----------------------------------------------------------------------
98: !
99: !     Compute solar distance factor and cosine solar zenith angle usi
100: !     day value where a round day (such as 213.0) refers to 0z at
101: !     Greenwich longitude.
102: !
103: !     Use formulas from Paltridge, G.W. and C.M.R. Platt 1976: Radiative
104: !     Processes in Meterology and Climatology, Elsevier Scientific
105: !     Publishing Company, New York  p. 57, p. 62,63.
106: !
107: !     Compute eccentricity factor (sun-earth distance factor)
108: !
109: #ifdef CLM
110:       eccf  = r2ceccf
111: #else
112:       theta = twopi*calday/dayspy
113:       eccf = 1.000110 + .034221*dcos(theta) + .001280*dsin(theta)       &
114:            & + .000719*dcos(2.*theta) + .000077*dsin(2.*theta)
115: #endif
116: !
117: !     Convert pressure from pascals to dynes/cm2
118: !
119:       do k = 1 , kz
120:         do i = 1 , iym1
121:           pmidrd(i,k) = pmid(i,k)*10.0
122:           pintrd(i,k) = pint(i,k)*10.0
123:         end do
124:       end do
125:       do i = 1 , iym1
126:         pintrd(i,kzp1) = pint(i,kz + 1)*10.0
127:       end do
128: !
129: !     Compute path quantities used in the longwave radiation:
130: !
131:       vmmr = amco2/amd
132:       cpwpl = vmmr*0.5/(gtigts*sslp)
133:       do i = 1 , iym1
134:         plh2o(i,1) = rgsslp*h2ommr(i,1)*pintrd(i,1)*pintrd(i,1)
135:         plco2(i,1) = co2vmr*cpwpl*pintrd(i,1)*pintrd(i,1)
136:         tclrsf(i,1) = 1.
137:       end do
138:       do k = 1 , kz
139:         do i = 1 , iym1
140:           plh2o(i,k+1) = plh2o(i,k)                                     &
141:                        & + rgsslp*(pintrd(i,k+1)**2-pintrd(i,k)**2)     &
142:                        & *h2ommr(i,k)
143:           plco2(i,k+1) = co2vmr*cpwpl*pintrd(i,k+1)**2
144:           tclrsf(i,k+1) = tclrsf(i,k)*(1.-cld(i,k+1))
145:         end do
146:       end do
147: !
148: !     Convert ozone volume mixing ratio to mass mixing ratio:
149: !
150:       vmmr = amo/amd
151:       do k = 1 , kz
152:         do i = 1 , iym1
153:           o3mmr(i,k) = vmmr*o3vmr(i,k)
154:         end do
155:       end do
156: !
157:       end subroutine radinp
</PRE>

<HR>

</BODY>
</HTML>
