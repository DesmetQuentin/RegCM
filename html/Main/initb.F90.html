<HTML>

<HEAD>
<TITLE>initb.F90</TITLE>
</HEAD>

<BODY background="back_granite.gif">
<FONT COLOR="#000000" FACE="Times">
<H1 ALIGN=CENTER>initb.F90</H1>
<HR>
<H2 ALIGN=CENTER>initb.F90</H2>
<HR>
</FONT>

<HR>

<PRE>
1: !::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
2: !
3: !    This file is part of ICTP RegCM.
4: !
5: !    ICTP RegCM is free software: you can redistribute it and/or modify
6: !    it under the terms of the GNU General Public License as published by
7: !    the Free Software Foundation, either version 3 of the License, or
8: !    (at your option) any later version.
9: !
10: !    ICTP RegCM is distributed in the hope that it will be useful,
11: !    but WITHOUT ANY WARRANTY; without even the implied warranty of
12: !    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
13: !    GNU General Public License for more details.
14: !
15: !    You should have received a copy of the GNU General Public License
16: !    along with ICTP RegCM.  If not, see <http://www.gnu.org/licenses/>.
17: !
18: !::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
19:  
<p><a name=initb><H3>initb</H3></a></p> Click <a href="./callingtree/initb_rite.html" TARGET=RITE_PANEL>HERE</a> to see the where initb is used.
<hr>
20:       subroutine initb
21: 
22: !::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
23: !     ***  provides constant initial fields to boundary subroutine
24: !     ***    soil textures are set in soilbc
25: !     ***    soil   colors are set in albedo
26: !
27: !     ***   units are si
28: !
29:       use <a href="./mod_dynparam.F90.html#mod_dynparam" TARGET=CENT_PANEL>mod_dynparam</a>
30:       use <a href="./mod_param2.F90.html#mod_param2" TARGET=CENT_PANEL>mod_param2</a>
31:       use <a href="./mod_bats.F90.html#mod_bats" TARGET=CENT_PANEL>mod_bats</a> , only : pptnc , pptc , veg2d , veg2d1 , ocld2d ,    &
32:                   & tg2d , tgb2d , taf2d , tlef2d , swt2d , srw2d ,     &
33:                   & ssw2d , dew2d , sag2d , scv2d , sice2d , gwet2d ,   &
34:                   & sena2d , evpa2d , rnos2d , rno2d , ocld2d , ircp2d ,&
35:                   & fsw2d , flw2d , sabv2d , sol2d , fswa2d , flwa2d ,  &
36:                   & prca2d , prnca2d , svga2d , sina2d , satbrt1 ,      &
37:                   & iexsol , xmopor , deptv , deprv , depuv
38:       use <a href="./mod_lake.f90.html#mod_lake" TARGET=CENT_PANEL>mod_lake</a> , only : initlk
39:       use <a href="./mod_main.F90.html#mod_main" TARGET=CENT_PANEL>mod_main</a>
40:       implicit none
41: ! 
42: ! Local variables
43: !
44:       integer :: ill , is , itex , jll , k , nlveg
45:       real(8) , dimension(20) :: slmo
46: !
47: !----------------------------------------------------------------------
48: !     slmo   : surface moisture availability in fraction of one.
49: !     data slmo/0.75,0.60,0.75,0.75,0.75,
50: !     &          0.80,0.60,0.10,0.90,0.90,
51: !     &          0.10,0.95,0.90,1.00,1.00,
52: !     &          0.60,0.75,0.85,0.85,0.85 /
53:       data slmo/0.65 , 0.45 , 0.60 , 0.60 , 0.65 , 0.65 , 0.55 , 0.10 , &
54:          & 0.90 , 0.80 , 0.20 , 0.90 , 0.90 , 1.00 , 1.00 , 0.50 ,      &
55:          & 0.50 , 0.65 , 0.60 , 0.60/       !BATS land types
56:  
57: !     ****** vgtran transforms mm4 surface types into bats surface types
58: !MM4  real(kind=8)  vgtran(13)
59: !MM4  data vgtran /5.,1.,2.,5.,3.,18.,0.,13.,11.,9.,12.,6.,7./
60: !MM4  integer ist
61:  
62: !     ****** typically resp=1.0 kg/m**2/s and changes by<10% in 10 days
63: !
64: #ifdef MPP1
65:       do jll = 1 , jendx
66:         do ill = 1 , iym1
67:           pptnc(ill,jll) = 0.
68:           pptc(ill,jll) = 0.
69: !MM4      ist=nint(satbrt(ill,jll))
70: !MM4      if(ist.le.13)then
71: !MM4      ist=ist
72: !MM4      else
73: !MM4      ist=7
74: !MM4      end if
75: !MM4      veg2d(ill,jll)=vgtran(ist)
76: !eros     note:  when using bats dataset comment line above
77:           veg2d(ill,jll) = satbrt(ill,jll)
78:           if ( satbrt(ill,jll).gt.13.9 .and. satbrt(ill,jll).lt.15.1 )  &
79:              & veg2d(ill,jll) = 0.
80:         end do
81:       end do
82:       do jll = 1 , jendx
83:         do ill = 1 , iym1
84:           do k = 1 , nnsg
85:             veg2d1(k,ill,jll) = satbrt1(k,ill,jll)
86:             if ( satbrt1(k,ill,jll).gt.13.9 .and. satbrt1(k,ill,jll)    &
87:                & .lt.15.1 ) veg2d1(k,ill,jll) = 0.
88:           end do
89:         end do
90:       end do
91: #else
92:       do jll = 1 , jxm1
93:         do ill = 1 , iym1
94:           pptnc(ill,jll) = 0.
95:           pptc(ill,jll) = 0.
96: !MM4      ist=nint(satbrt(ill,jll))
97: !MM4      if(ist.le.13)then
98: !MM4      ist=ist
99: !MM4      else
100: !MM4      ist=7
101: !MM4      end if
102: !MM4      veg2d(ill,jll)=vgtran(ist)
103: !eros     note:  when using bats dataset comment line above
104:           veg2d(ill,jll) = satbrt(ill,jll)
105:           if ( satbrt(ill,jll).gt.13.9 .and. satbrt(ill,jll).lt.15.1 )  &
106:              & veg2d(ill,jll) = 0.
107:         end do
108:       end do
109:       do jll = 1 , jxm1
110:         do ill = 1 , iym1
111:           do k = 1 , nnsg
112:             veg2d1(k,ill,jll) = satbrt1(k,ill,jll)
113:             if ( satbrt1(k,ill,jll).gt.13.9 .and. satbrt1(k,ill,jll)    &
114:                & .lt.15.1 ) veg2d1(k,ill,jll) = 0.
115:           end do
116:         end do
117:       end do
118: #endif
119:  
120: !     ******  initialize hostetler lake model
121: #ifdef MPP1
122:       if ( lakemod.eq.1 ) call <a href="./mod_lake.f90.html#initlk" TARGET=CENT_PANEL>initlk</a>(veg2d1,iym1sg,jxpsg)
123:       do jll = 1 , jendx
124:         do ill = 1 , iym1
125:           do k = 1 , nnsg
126:             if ( veg2d1(k,ill,jll).lt.0.5 ) then
127:               ocld2d(k,ill,jll) = 0.
128:             else
129:               ocld2d(k,ill,jll) = 1.
130:             end if
131:             nlveg = nint(veg2d1(k,ill,jll))
132:             if ( nlveg.eq.0 ) then
133:               nlveg = 15
134:             else
135:               nlveg = nlveg
136:             end if
137: !sol        itex=int(text2d(k,ill,jll))
138:             itex = iexsol(nlveg)
139:             tg2d(k,ill,jll) = tgb(ill,jll)
140:             tgb2d(k,ill,jll) = tgb(ill,jll)
141:             taf2d(k,ill,jll) = tgb(ill,jll)
142:             tlef2d(k,ill,jll) = tgb(ill,jll)
143:  
144: !           ******  initialize soil moisture in the 3 layers
145:             is = nint(satbrt1(k,ill,jll))
146:             swt2d(k,ill,jll) = deptv(nlveg)*xmopor(itex)*slmo(is)
147:             srw2d(k,ill,jll) = deprv(nlveg)*xmopor(itex)*slmo(is)
148:             ssw2d(k,ill,jll) = depuv(nlveg)*xmopor(itex)*slmo(is)
149:  
150:             dew2d(k,ill,jll) = 0.
151:             sag2d(k,ill,jll) = 0.
152:             scv2d(k,ill,jll) = dmax1(snowc(k,ill,jll),0.D0)
153:             sice2d(k,ill,jll) = 0.
154:             gwet2d(k,ill,jll) = 0.5
155:             sena2d(k,ill,jll) = 0.
156:             evpa2d(k,ill,jll) = 0.
157:             rnos2d(k,ill,jll) = 0.
158:             rno2d(k,ill,jll) = 0.
159:             if ( sice2d(k,ill,jll).gt.0. ) ocld2d(k,ill,jll) = 2.
160:             ircp2d(k,ill,jll) = 0.
161:           end do
162:         end do
163:       end do
164: #else
165:       if ( lakemod.eq.1 ) call <a href="./mod_lake.f90.html#initlk" TARGET=CENT_PANEL>initlk</a>(veg2d1,iym1sg,jxm1sg)
166: 
167:       do jll = 1 , jxm1
168:         do ill = 1 , iym1
169:           do k = 1 , nnsg
170:             if ( veg2d1(k,ill,jll).lt.0.5 ) then
171:               ocld2d(k,ill,jll) = 0.
172:             else
173:               ocld2d(k,ill,jll) = 1.
174:             end if
175:             nlveg = nint(veg2d1(k,ill,jll))
176:             if ( nlveg.eq.0 ) then
177:               nlveg = 15
178:             else
179:               nlveg = nlveg
180:             end if
181: !sol        itex=int(text2d(k,ill,jll))
182:             itex = iexsol(nlveg)
183:             tg2d(k,ill,jll) = tgb(ill,jll)
184:             tgb2d(k,ill,jll) = tgb(ill,jll)
185:             taf2d(k,ill,jll) = tgb(ill,jll)
186:             tlef2d(k,ill,jll) = tgb(ill,jll)
187: 
188: !           ******  initialize soil moisture in the 3 layers
189:             is = nint(satbrt1(k,ill,jll))
190:             swt2d(k,ill,jll) = deptv(nlveg)*xmopor(itex)*slmo(is)
191:             srw2d(k,ill,jll) = deprv(nlveg)*xmopor(itex)*slmo(is)
192:             ssw2d(k,ill,jll) = depuv(nlveg)*xmopor(itex)*slmo(is)
193: 
194:             dew2d(k,ill,jll) = 0.
195:             sag2d(k,ill,jll) = 0.
196:             scv2d(k,ill,jll) = dmax1(snowc(k,ill,jll),0.D0)
197:             sice2d(k,ill,jll) = 0.
198:             gwet2d(k,ill,jll) = 0.5
199:             sena2d(k,ill,jll) = 0.
200:             evpa2d(k,ill,jll) = 0.
201:             rnos2d(k,ill,jll) = 0.
202:             rno2d(k,ill,jll) = 0.
203:             if ( sice2d(k,ill,jll).gt.0. ) ocld2d(k,ill,jll) = 2.
204:             ircp2d(k,ill,jll) = 0.
205:           end do
206:         end do
207:       end do
208: #endif
209:  
210: #ifdef MPP1
211:       do jll = 1 , jendx
212:         do ill = 1 , iym1
213:           fsw2d(ill,jll) = 0.
214:           flw2d(ill,jll) = 0.
215:           sabv2d(ill,jll) = 0.
216:           sol2d(ill,jll) = 0.
217:           fswa2d(ill,jll) = 0.
218:           flwa2d(ill,jll) = 0.
219:           prca2d(ill,jll) = 0.
220:           prnca2d(ill,jll) = 0.
221:           svga2d(ill,jll) = 0.
222:           sina2d(ill,jll) = 0.
223:         end do
224:       end do
225: #else
226:       do jll = 1 , jxm1
227:         do ill = 1 , iym1
228:           fsw2d(ill,jll) = 0.
229:           flw2d(ill,jll) = 0.
230:           sabv2d(ill,jll) = 0.
231:           sol2d(ill,jll) = 0.
232:           fswa2d(ill,jll) = 0.
233:           flwa2d(ill,jll) = 0.
234:           prca2d(ill,jll) = 0.
235:           prnca2d(ill,jll) = 0.
236:           svga2d(ill,jll) = 0.
237:           sina2d(ill,jll) = 0.
238:         end do
239:       end do
240: #endif
241:  
242:       end subroutine initb
</PRE>

<HR>

</BODY>
</HTML>
