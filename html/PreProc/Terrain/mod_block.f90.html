<HTML>

<HEAD>
<TITLE>mod_block.f90</TITLE>
</HEAD>

<BODY background="back_granite.gif">
<FONT COLOR="#000000" FACE="Times">
<H1 ALIGN=CENTER>mod_block.f90</H1>
<HR>
<H2 ALIGN=CENTER>mod_block.f90</H2>
<HR>
</FONT>

<HR>

<PRE>
1: !::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
2: !
3: !    This file is part of ICTP RegCM.
4: !
5: !    ICTP RegCM is free software: you can redistribute it and/or modify
6: !    it under the terms of the GNU General Public License as published by
7: !    the Free Software Foundation, either version 3 of the License, or
8: !    (at your option) any later version.
9: !
10: !    ICTP RegCM is distributed in the hope that it will be useful,
11: !    but WITHOUT ANY WARRANTY; without even the implied warranty of
12: !    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
13: !    GNU General Public License for more details.
14: !
15: !    You should have received a copy of the GNU General Public License
16: !    along with ICTP RegCM.  If not, see <http://www.gnu.org/licenses/>.
17: !
18: !::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
19: 
<p><a name=mod_block><H3>mod_block</H3></a></p>20:       module mod_block
21:       implicit none
22:       integer :: nobs
23:       integer :: nnc
24:       integer :: iblk , iter, jter
25:       real(4) , allocatable , dimension(:,:) :: clay , sand
26:       real(4) , allocatable , dimension(:) :: ht , ht2 , htsd
27:       real(4) , allocatable , dimension(:) :: xobs , yobs
28:       real(8) , allocatable , dimension(:,:) :: lnd8
29:       real(4) , dimension(50) :: stores
30:       real(4) :: grdlnmn , grdltmn
31:       real(4) :: xmaxlat , xmaxlon , xminlat , xminlon
32:       real(4) :: dsinm , rin , xn , xnc
33:       real(4) :: dxcen , dycen
34: 
35:       contains
36: 
<p><a name=allocate_block><H3>allocate_block</H3></a></p> Click <a href="./callingtree/allocate_block_rite.html" TARGET=RITE_PANEL>HERE</a> to see the where allocate_block is used.
<hr>
37:       subroutine allocate_block(ni, nj)
38:         implicit none
39:         integer , intent(in) :: ni , nj
40:         iter = ni
41:         jter = nj
42:         iblk = (iter*jter)/2
43:         allocate(lnd8(iter,jter))
44:         allocate(clay(iblk,2))
45:         allocate(sand(iblk,2))
46:         allocate(ht(iblk))
47:         allocate(ht2(iblk))
48:         allocate(htsd(iblk))
49:         allocate(xobs(iblk))
50:         allocate(yobs(iblk))
51:       end subroutine
52: 
<p><a name=free_block><H3>free_block</H3></a></p> Click <a href="./callingtree/free_block_rite.html" TARGET=RITE_PANEL>HERE</a> to see the where free_block is used.
<hr>
53:       subroutine free_block
54:         iter = 0
55:         jter = 0
56:         iblk = 0
57:         if (allocated(lnd8)) deallocate(lnd8)
58:         if (allocated(clay)) deallocate(clay)
59:         if (allocated(sand)) deallocate(sand)
60:         if (allocated(ht)) deallocate(ht)
61:         if (allocated(ht2)) deallocate(ht2)
62:         if (allocated(htsd)) deallocate(htsd)
63:         if (allocated(xobs)) deallocate(xobs)
64:         if (allocated(yobs)) deallocate(yobs)
65:       end subroutine
66: 
<p><a name=mxmnll><H3>mxmnll</H3></a></p> Click <a href="./callingtree/mxmnll_rite.html" TARGET=RITE_PANEL>HERE</a> to see the where mxmnll is used.
<hr>
67:       subroutine mxmnll(iy,jx,clon,xlon,xlat,ntypec)
68:       implicit none
69: !
70: ! Dummy arguments
71: !
72:       real(4) :: clon
73:       integer :: iy , jx , ntypec
74:       real(4) , dimension(iy,jx) :: xlat , xlon
75:       intent (in) clon , iy , jx , ntypec , xlat , xlon
76: !
77: ! Local variables
78: !
79:       integer :: i , j
80: !
81: !     PURPOSE : FINDS THE MAXIMUM AND MINIMUM LATITUDE AND LONGITUDE
82: !
83:       xmaxlat = -90
84:       xminlat = 90
85:       xminlon = 999999.
86:       xmaxlon = -999999.
87: !
88:       do i = 1 , iy
89:         do j = 1 , jx
90:           xminlat = amin1(xminlat,xlat(i,j))
91:           xmaxlat = amax1(xmaxlat,xlat(i,j))
92:         end do
93:       end do
94:       do i = 1 , iy
95:         do j = 1 , jx
96:           if ( clon>=0.0 ) then
97:             if ( xlon(i,j)>=0.0 ) then
98:               xminlon = amin1(xminlon,xlon(i,j))
99:               xmaxlon = amax1(xmaxlon,xlon(i,j))
100:             else if ( abs(clon-xlon(i,j))<abs(clon-(xlon(i,j)+360.)) )  &
101:                     & then
102:               xminlon = amin1(xminlon,xlon(i,j))
103:               xmaxlon = amax1(xmaxlon,xlon(i,j))
104:             else
105:               xminlon = amin1(xminlon,xlon(i,j)+360.)
106:               xmaxlon = amax1(xmaxlon,xlon(i,j)+360.)
107:             end if
108:           else if ( xlon(i,j)<0.0 ) then
109:             xminlon = amin1(xminlon,xlon(i,j))
110:             xmaxlon = amax1(xmaxlon,xlon(i,j))
111:           else if ( abs(clon-xlon(i,j))<abs(clon-(xlon(i,j)-360.)) )    &
112:                   & then
113:             xminlon = amin1(xminlon,xlon(i,j))
114:             xmaxlon = amax1(xmaxlon,xlon(i,j))
115:           else
116:             xminlon = amin1(xminlon,xlon(i,j)-360.)
117:             xmaxlon = amax1(xmaxlon,xlon(i,j)-360.)
118:           end if
119:         end do
120:       end do
121:  
122:       print 99001 , xminlat , xmaxlat , xminlon , xmaxlon , ntypec
123: !--------initialize minimum lat and lon of data from tape
124:       grdltmn = xminlat + 5.
125:       grdlnmn = xminlon + 5.
126: 99001 format (1x,'xminlat,xmaxlat,xminlon,xmaxlon,ntypec= ',4F10.2,i10)
127: !
128:       end subroutine mxmnll
129: 
130:       end module mod_block
</PRE>

<HR>

</BODY>
</HTML>
