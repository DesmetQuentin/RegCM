<HTML>

<HEAD>
<TITLE>mod_ein75.f90</TITLE>
</HEAD>

<BODY background="back_granite.gif">
<FONT COLOR="#000000" FACE="Times">
<H1 ALIGN=CENTER>mod_ein75.f90</H1>
<HR>
<H2 ALIGN=CENTER>mod_ein75.f90</H2>
<HR>
</FONT>

<HR>

<PRE>
1: !::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
2: !
3: !    This file is part of ICTP RegCM.
4: !
5: !    ICTP RegCM is free software: you can redistribute it and/or modify
6: !    it under the terms of the GNU General Public License as published by
7: !    the Free Software Foundation, either version 3 of the License, or
8: !    (at your option) any later version.
9: !
10: !    ICTP RegCM is distributed in the hope that it will be useful,
11: !    but WITHOUT ANY WARRANTY; without even the implied warranty of
12: !    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
13: !    GNU General Public License for more details.
14: !
15: !    You should have received a copy of the GNU General Public License
16: !    along with ICTP RegCM.  If not, see <http://www.gnu.org/licenses/>.
17: !
18: !::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
19: 
<p><a name=mod_ein75><H3>mod_ein75</H3></a></p>20:       module mod_ein75
21:       use <a href="./mod_dynparam.F90.html#mod_dynparam" TARGET=CENT_PANEL>mod_dynparam</a>
22: 
23:       implicit none
24: 
25:       private
26: 
27:       integer , parameter :: klev = 23 , jlat = 241 , ilon = 480
28: 
29:       real(4) , target , dimension(ilon,jlat,klev*3) :: b2
30:       real(4) , target , dimension(ilon,jlat,klev*2) :: d2
31:       real(4) , allocatable , target , dimension(:,:,:) :: b3
32:       real(4) , allocatable , target , dimension(:,:,:) :: d3
33: 
34:       real(4) , pointer :: u3(:,:,:) , v3(:,:,:)
35:       real(4) , pointer :: h3(:,:,:) , q3(:,:,:) , t3(:,:,:)
36:       real(4) , pointer :: uvar(:,:,:) , vvar(:,:,:)
37:       real(4) , pointer :: hvar(:,:,:) , rhvar(:,:,:) , tvar(:,:,:)
38: 
39:       integer(2) , dimension(ilon,jlat,37) :: work
40:       real(4) , dimension(jlat) :: glat
41:       real(4) , dimension(ilon) :: glon
42:       real(4) , dimension(klev) :: sigma1 , sigmar
43: 
44:       public :: getein75 , headerein75
45: 
46:       contains
47: 
<p><a name=getein75><H3>getein75</H3></a></p> Click <a href="./callingtree/getein75_rite.html" TARGET=RITE_PANEL>HERE</a> to see the where getein75 is used.
<hr>
48:       subroutine getein75(idate)
49:       use <a href="./mod_date.f90.html#mod_date" TARGET=CENT_PANEL>mod_date</a> , only : julian
50:       use <a href="./mod_grid.f90.html#mod_grid" TARGET=CENT_PANEL>mod_grid</a>
51:       use <a href="./mod_write.f90.html#mod_write" TARGET=CENT_PANEL>mod_write</a>
52:       use <a href="./mod_interp.f90.html#mod_interp" TARGET=CENT_PANEL>mod_interp</a> , only : bilinx2
53:       use <a href="./mod_vertint.f90.html#mod_vertint" TARGET=CENT_PANEL>mod_vertint</a>
54:       use <a href="./mod_hgt.f90.html#mod_hgt" TARGET=CENT_PANEL>mod_hgt</a>
55:       use <a href="./mod_humid.f90.html#mod_humid" TARGET=CENT_PANEL>mod_humid</a>
56:       use <a href="./mod_mksst.f90.html#mod_mksst" TARGET=CENT_PANEL>mod_mksst</a>
57:       use <a href="./mod_uvrot.f90.html#mod_uvrot" TARGET=CENT_PANEL>mod_uvrot</a>
58:       use <a href="./mod_vectutil.f90.html#mod_vectutil" TARGET=CENT_PANEL>mod_vectutil</a>
59:       implicit none
60: !
61: ! Dummy arguments
62: !
63:       integer :: idate
64: !
65: ! Local variables
66: !
67:       integer :: nmop , nyrp
68:       real(4) :: wt
69: !
70: !     D      BEGIN LOOP OVER NTIMES
71: !
72:       call <a href="./mod_ein75.f90.html#ein756hour" TARGET=CENT_PANEL>ein756hour</a>(dattyp,idate,globidate1)
73:       write (*,*) 'READ IN fields at DATE:' , idate
74: !
75: !     HORIZONTAL INTERPOLATION OF BOTH THE SCALAR AND VECTOR FIELDS
76: !
77:       call <a href="./mod_interp.f90.html#bilinx2" TARGET=CENT_PANEL>bilinx2</a>(b3,b2,xlon,xlat,glon,glat,ilon,jlat,jx,iy,klev*3)
78:       call <a href="./mod_interp.f90.html#bilinx2" TARGET=CENT_PANEL>bilinx2</a>(d3,d2,dlon,dlat,glon,glat,ilon,jlat,jx,iy,klev*2)
79: !
80: !     ROTATE U-V FIELDS AFTER HORIZONTAL INTERPOLATION
81: !
82:       call <a href="./mod_uvrot.f90.html#uvrot4" TARGET=CENT_PANEL>uvrot4</a>(u3,v3,dlon,dlat,clon,clat,grdfac,jx,iy,klev,plon,plat,&
83:                 & iproj)
84: !
85: !     X X X X X X X X X X X X X X X X X X X X X X X X X X X X X X X X X
86: !     X X
87: !     V E R T I C A L   I N T E R P O L A T I O N
88: !
89: !     X X X X X X X X X X X X X X X X X X X X X X X X X X X X X X X X X
90: !     X X
91: !HH:  CHANGE THE VERTICAL ORDER.
92:       call <a href="./mod_vectutil.f90.html#top2btm" TARGET=CENT_PANEL>top2btm</a>(t3,jx,iy,klev)
93:       call <a href="./mod_vectutil.f90.html#top2btm" TARGET=CENT_PANEL>top2btm</a>(q3,jx,iy,klev)
94:       call <a href="./mod_vectutil.f90.html#top2btm" TARGET=CENT_PANEL>top2btm</a>(h3,jx,iy,klev)
95:       call <a href="./mod_vectutil.f90.html#top2btm" TARGET=CENT_PANEL>top2btm</a>(u3,jx,iy,klev)
96:       call <a href="./mod_vectutil.f90.html#top2btm" TARGET=CENT_PANEL>top2btm</a>(v3,jx,iy,klev)
97: !HH:OVER
98: !
99: !     ******           NEW CALCULATION OF P* ON RCM TOPOGRAPHY.
100:       call <a href="./mod_vertint.f90.html#intgtb" TARGET=CENT_PANEL>intgtb</a>(pa,za,tlayer,topogm,t3,h3,sigmar,jx,iy,klev)
101:  
102:       call <a href="./mod_vertint.f90.html#intpsn" TARGET=CENT_PANEL>intpsn</a>(ps4,topogm,pa,za,tlayer,ptop,jx,iy)
103:       call <a href="./mod_vectutil.f90.html#p1p2" TARGET=CENT_PANEL>p1p2</a>(b3pd,ps4,jx,iy)
104:  
105: !     CALL HUMID1(T3,Q3,100.,0.0,SIGMA1,JX,IY,klev)
106: !
107: !     F0  DETERMINE SURFACE TEMPS ON RCM TOPOGRAPHY.
108: !     INTERPOLATION FROM PRESSURE LEVELS AS IN INTV2
109:       call <a href="./mod_vertint.f90.html#intv3" TARGET=CENT_PANEL>intv3</a>(ts4,t3,ps4,sigmar,ptop,jx,iy,klev)
110:  
111:       if ( ssttyp/='OI_WK' .and. ssttyp/='OI2WK' ) then
112: !       F1  CALCULATE SSTS FOR DATE FROM OBSERVED SSTS
113:         print * , 'INPUT DAY FOR SST DATA ACQUISITION:' , idate
114:         call <a href="./mod_date.f90.html#julian" TARGET=CENT_PANEL>julian</a>(idate,nyrp,nmop,wt)
115: !
116:         if ( ssttyp=='OI2ST' ) then
117:           call <a href="./mod_mksst.f90.html#mkssta" TARGET=CENT_PANEL>mkssta</a>(ts4,sst1,sst2,ice1,ice2,topogm,xlandu,jx,iy,nyrp, &
118:                  &    nmop,wt)
119:         else
120:           call <a href="./mod_mksst.f90.html#mksst" TARGET=CENT_PANEL>mksst</a>(ts4,ice1,ice2,topogm,xlandu,jx,iy,nyrp,nmop,wt)
121:         end if
122:       else
123:         if ( ssttyp=='OI2WK' ) then
124:           call <a href="./mod_mksst.f90.html#mksst2a" TARGET=CENT_PANEL>mksst2a</a>(ts4,sst1,sst2,ice1,ice2,topogm,xlandu,jx,iy,     &
125:                  &     idate/100)
126:         else
127:           call <a href="./mod_mksst.f90.html#mksst2" TARGET=CENT_PANEL>mksst2</a>(ts4,sst1,sst2,topogm,xlandu,jx,iy,idate/100)
128:         end if
129:       end if
130:  
131: !     F2  DETERMINE P* AND HEIGHT.
132: !
133: !     F3  INTERPOLATE U, V, T, AND Q.
134:       call <a href="./mod_vertint.f90.html#intv1" TARGET=CENT_PANEL>intv1</a>(u4,u3,b3pd,sigma2,sigmar,ptop,jx,iy,kz,klev)
135:       call <a href="./mod_vertint.f90.html#intv1" TARGET=CENT_PANEL>intv1</a>(v4,v3,b3pd,sigma2,sigmar,ptop,jx,iy,kz,klev)
136: !
137:       call <a href="./mod_vertint.f90.html#intv2" TARGET=CENT_PANEL>intv2</a>(t4,t3,ps4,sigma2,sigmar,ptop,jx,iy,kz,klev)
138:  
139:       call <a href="./mod_vertint.f90.html#intv1" TARGET=CENT_PANEL>intv1</a>(q4,q3,ps4,sigma2,sigmar,ptop,jx,iy,kz,klev)
140:       call <a href="./mod_humid.f90.html#humid2" TARGET=CENT_PANEL>humid2</a>(t4,q4,ps4,ptop,sigma2,jx,iy,kz)
141: !
142: !     F4  DETERMINE H
143:       call <a href="./mod_hgt.f90.html#hydrost" TARGET=CENT_PANEL>hydrost</a>(h4,t4,topogm,ps4,ptop,sigmaf,sigma2,dsigma,jx,iy,kz)
144: !
145: !     G   WRITE AN INITIAL FILE FOR THE RCM
146:       call <a href="./mod_write.f90.html#writef" TARGET=CENT_PANEL>writef</a>(ptop,idate)
147: !
148:       end subroutine getein75
149: 
<p><a name=ein756hour><H3>ein756hour</H3></a></p> Click <a href="./callingtree/ein756hour_rite.html" TARGET=RITE_PANEL>HERE</a> to see the where ein756hour is used.
<hr>
150:       subroutine ein756hour(dattyp,idate,idate0)
151:       use <a href="#" TARGET=CENT_PANEL>netcdf</a>
152:       implicit none
153: !
154: ! Dummy arguments
155: !
156:       character(5) :: dattyp
157:       integer :: idate , idate0
158:       intent (in) dattyp , idate , idate0
159: !
160: ! Local variables
161: !
162:       integer :: i , inet , it , j , k , k4 , kkrec , month , nday ,    &
163:                & nhour , nyear , istatus
164:       character(24) :: inname
165:       character(256) :: pathaddname
166:       logical :: there
167: !     character(1) , dimension(5) :: varname
168:       real(8) :: xadd , xscale
169: !
170:       integer , dimension(10) , save :: icount , istart
171:       integer , dimension(5,4) , save :: inet6
172:       real(8) , dimension(5,4) , save :: xoff , xscl
173: !
174: !     This is the latitude, longitude dimension of the grid to be read.
175: !     This corresponds to the lat and lon dimension variables in the
176: !     netCDF file.
177: !
178: !     The data are packed into short integers (INTEGER*2).  The array
179: !     work will be used to hold the packed integers.  The array 'x'
180: !     will contain the unpacked data.
181: !
182: !     DATA ARRAY AND WORK ARRAY
183: !
184: !     data varname/'t' , 'z' , 'r' , 'u' , 'v'/
185: !
186: !     Below in the ncopen call is the file name of the netCDF file.
187: !     You may want to add code to read in the file name and the
188: !     variable name.
189: !     OPEN FILE AND GET FILES ID AND VARIABLE ID(S)
190: !
191: !bxq
192:       if ( idate<1989010100 .or. idate>2007123118 ) then
193:         write (*,*) 'EIN75 datasets is just available from' ,           &
194:                    &' 1989010100 to 2007123118'
195:         stop
196:       end if
197:  
198:       nyear = idate/1000000
199:       month = idate/10000 - nyear*100
200:       nday = idate/100 - nyear*10000 - month*100
201:       nhour = idate - nyear*1000000 - month*10000 - nday*100
202:       if ( idate==idate0 .or.                                           &
203:          & (mod(idate,100000)==10100 .and. mod(idate,1000000)/=110100) )&
204:          & then
205:         do k4 = 1 , 4
206:           do kkrec = 1 , 5
207:             if ( kkrec==1 ) then
208:               if ( k4==1 ) then
209:                 write (inname,99001) nyear , 'air.' , nyear
210:               else if ( k4==2 ) then
211:                 write (inname,99002) nyear , 'air.' , nyear
212:               else if ( k4==3 ) then
213:                 write (inname,99003) nyear , 'air.' , nyear
214:               else if ( k4==4 ) then
215:                 write (inname,99004) nyear , 'air.' , nyear
216:               else
217:               end if
218:             else if ( kkrec==2 ) then
219:               if ( k4==1 ) then
220:                 write (inname,99001) nyear , 'hgt.' , nyear
221:               else if ( k4==2 ) then
222:                 write (inname,99002) nyear , 'hgt.' , nyear
223:               else if ( k4==3 ) then
224:                 write (inname,99003) nyear , 'hgt.' , nyear
225:               else if ( k4==4 ) then
226:                 write (inname,99004) nyear , 'hgt.' , nyear
227:               else
228:               end if
229:             else if ( kkrec==3 ) then
230:               if ( k4==1 ) then
231:                 write (inname,99005) nyear , 'rhum.' , nyear
232:               else if ( k4==2 ) then
233:                 write (inname,99006) nyear , 'rhum.' , nyear
234:               else if ( k4==3 ) then
235:                 write (inname,99007) nyear , 'rhum.' , nyear
236:               else if ( k4==4 ) then
237:                 write (inname,99008) nyear , 'rhum.' , nyear
238:               else
239:               end if
240:             else if ( kkrec==4 ) then
241:               if ( k4==1 ) then
242:                 write (inname,99005) nyear , 'uwnd.' , nyear
243:               else if ( k4==2 ) then
244:                 write (inname,99006) nyear , 'uwnd.' , nyear
245:               else if ( k4==3 ) then
246:                 write (inname,99007) nyear , 'uwnd.' , nyear
247:               else if ( k4==4 ) then
248:                 write (inname,99008) nyear , 'uwnd.' , nyear
249:               else
250:               end if
251:             else if ( kkrec==5 ) then
252:               if ( k4==1 ) then
253:                 write (inname,99005) nyear , 'vwnd.' , nyear
254:               else if ( k4==2 ) then
255:                 write (inname,99006) nyear , 'vwnd.' , nyear
256:               else if ( k4==3 ) then
257:                 write (inname,99007) nyear , 'vwnd.' , nyear
258:               else if ( k4==4 ) then
259:                 write (inname,99008) nyear , 'vwnd.' , nyear
260:               else
261:               end if
262:             else
263:             end if
264:  
265:             pathaddname = trim(inpglob)//pthsep//dattyp//pthsep//inname
266:             inquire (file=pathaddname,exist=there)
267:             if ( .not.there ) then
268:               print * , trim(pathaddname) , ' is not available'
269:               stop
270:             end if
271:             istatus = nf90_open(pathaddname,nf90_nowrite,               &
272:                    & inet6(kkrec,k4))
273:             istatus = nf90_get_att(inet6(kkrec,k4),5,'scale_factor',    &
274:                    & xscl(kkrec,k4))
275:             istatus = nf90_get_att(inet6(kkrec,k4),5,'add_offset',      &
276:                    & xoff(kkrec,k4))
277:             write (*,*) inet6(kkrec,k4) , trim(pathaddname) ,           &
278:                       & xscl(kkrec,k4) , xoff(kkrec,k4)
279:           end do
280:         end do
281:  
282:       end if
283:  
284:       k4 = nhour/6 + 1
285:       it = nday
286:       if ( month==2 ) it = it + 31
287:       if ( month==3 ) it = it + 59
288:       if ( month==4 ) it = it + 90
289:       if ( month==5 ) it = it + 120
290:       if ( month==6 ) it = it + 151
291:       if ( month==7 ) it = it + 181
292:       if ( month==8 ) it = it + 212
293:       if ( month==9 ) it = it + 243
294:       if ( month==10 ) it = it + 273
295:       if ( month==11 ) it = it + 304
296:       if ( month==12 ) it = it + 334
297:       if ( mod(nyear,4)==0 .and. month>2 ) it = it + 1
298:       if ( mod(nyear,100)==0 .and. month>2 ) it = it - 1
299:       if ( mod(nyear,400)==0 .and. month>2 ) it = it + 1
300:       do k = 1 , 4
301:         istart(k) = 1
302:       end do
303:       do k = 5 , 10
304:         istart(k) = 0
305:         icount(k) = 0
306:       end do
307:       icount(1) = ilon
308:       icount(2) = jlat
309:       icount(3) = 37
310:       icount(4) = 365
311:       if ( mod(nyear,4)==0 ) icount(4) = 366
312:       if ( mod(nyear,100)==0 ) icount(4) = 365
313:       if ( mod(nyear,400)==0 ) icount(4) = 366
314:       istart(4) = it
315:       icount(4) = 1
316: !bxq_
317:       do kkrec = 1 , 5
318:         inet = inet6(kkrec,k4)
319:         istatus = nf90_get_var(inet,5,work,istart,icount)
320:         xscale = xscl(kkrec,k4)
321:         xadd = xoff(kkrec,k4)
322:         if ( kkrec==1 ) then
323:           do j = 1 , jlat
324:             do i = 1 , ilon
325: !             Tvar(i,jlat+1-j,k)=work(i,j,k)*xscale+xadd
326:               tvar(i,jlat+1-j,1) = work(i,j,1)*xscale + xadd
327:               tvar(i,jlat+1-j,2) = work(i,j,2)*xscale + xadd
328:               tvar(i,jlat+1-j,3) = work(i,j,3)*xscale + xadd
329:               tvar(i,jlat+1-j,4) = work(i,j,4)*xscale + xadd
330:               tvar(i,jlat+1-j,5) = work(i,j,5)*xscale + xadd
331:               tvar(i,jlat+1-j,6) = work(i,j,6)*xscale + xadd
332:               tvar(i,jlat+1-j,7) = work(i,j,7)*xscale + xadd
333:               tvar(i,jlat+1-j,8) = work(i,j,8)*xscale + xadd
334:               tvar(i,jlat+1-j,9) = work(i,j,9)*xscale + xadd
335:               tvar(i,jlat+1-j,10) = work(i,j,10)*xscale + xadd
336:               tvar(i,jlat+1-j,11) = work(i,j,11)*xscale + xadd
337:               tvar(i,jlat+1-j,12) = work(i,j,13)*xscale + xadd
338:               tvar(i,jlat+1-j,13) = work(i,j,15)*xscale + xadd
339:               tvar(i,jlat+1-j,14) = work(i,j,17)*xscale + xadd
340:               tvar(i,jlat+1-j,15) = work(i,j,18)*xscale + xadd
341:               tvar(i,jlat+1-j,16) = work(i,j,20)*xscale + xadd
342:               tvar(i,jlat+1-j,17) = work(i,j,22)*xscale + xadd
343:               tvar(i,jlat+1-j,18) = work(i,j,24)*xscale + xadd
344:               tvar(i,jlat+1-j,19) = work(i,j,26)*xscale + xadd
345:               tvar(i,jlat+1-j,20) = work(i,j,28)*xscale + xadd
346:               tvar(i,jlat+1-j,21) = work(i,j,31)*xscale + xadd
347:               tvar(i,jlat+1-j,22) = work(i,j,34)*xscale + xadd
348:               tvar(i,jlat+1-j,23) = work(i,j,37)*xscale + xadd
349:             end do
350:           end do
351:         else if ( kkrec==2 ) then
352:           do j = 1 , jlat
353:             do i = 1 , ilon
354: !             Hvar(i,jlat+1-j,k)=work(i,j,k)*xscale+xadd
355:               hvar(i,jlat+1-j,1) = work(i,j,1)*xscale + xadd
356:               hvar(i,jlat+1-j,2) = work(i,j,2)*xscale + xadd
357:               hvar(i,jlat+1-j,3) = work(i,j,3)*xscale + xadd
358:               hvar(i,jlat+1-j,4) = work(i,j,4)*xscale + xadd
359:               hvar(i,jlat+1-j,5) = work(i,j,5)*xscale + xadd
360:               hvar(i,jlat+1-j,6) = work(i,j,6)*xscale + xadd
361:               hvar(i,jlat+1-j,7) = work(i,j,7)*xscale + xadd
362:               hvar(i,jlat+1-j,8) = work(i,j,8)*xscale + xadd
363:               hvar(i,jlat+1-j,9) = work(i,j,9)*xscale + xadd
364:               hvar(i,jlat+1-j,10) = work(i,j,10)*xscale + xadd
365:               hvar(i,jlat+1-j,11) = work(i,j,11)*xscale + xadd
366:               hvar(i,jlat+1-j,12) = work(i,j,13)*xscale + xadd
367:               hvar(i,jlat+1-j,13) = work(i,j,15)*xscale + xadd
368:               hvar(i,jlat+1-j,14) = work(i,j,17)*xscale + xadd
369:               hvar(i,jlat+1-j,15) = work(i,j,18)*xscale + xadd
370:               hvar(i,jlat+1-j,16) = work(i,j,20)*xscale + xadd
371:               hvar(i,jlat+1-j,17) = work(i,j,22)*xscale + xadd
372:               hvar(i,jlat+1-j,18) = work(i,j,24)*xscale + xadd
373:               hvar(i,jlat+1-j,19) = work(i,j,26)*xscale + xadd
374:               hvar(i,jlat+1-j,20) = work(i,j,28)*xscale + xadd
375:               hvar(i,jlat+1-j,21) = work(i,j,31)*xscale + xadd
376:               hvar(i,jlat+1-j,22) = work(i,j,34)*xscale + xadd
377:               hvar(i,jlat+1-j,23) = work(i,j,37)*xscale + xadd
378:             end do
379:           end do
380:           do k = 1 , klev
381:             do j = 1 , jlat
382:               do i = 1 , ilon
383:                 hvar(i,j,k) = hvar(i,j,k)/9.80616
384:               end do
385:             end do
386:           end do
387:         else if ( kkrec==3 ) then
388:           do j = 1 , jlat
389:             do i = 1 , ilon
390: !             RHvar(i,jlat+1-j,k)=work(i,j,k)*xscale+xadd
391:               rhvar(i,jlat+1-j,1) = work(i,j,1)*xscale + xadd
392:               rhvar(i,jlat+1-j,2) = work(i,j,2)*xscale + xadd
393:               rhvar(i,jlat+1-j,3) = work(i,j,3)*xscale + xadd
394:               rhvar(i,jlat+1-j,4) = work(i,j,4)*xscale + xadd
395:               rhvar(i,jlat+1-j,5) = work(i,j,5)*xscale + xadd
396:               rhvar(i,jlat+1-j,6) = work(i,j,6)*xscale + xadd
397:               rhvar(i,jlat+1-j,7) = work(i,j,7)*xscale + xadd
398:               rhvar(i,jlat+1-j,8) = work(i,j,8)*xscale + xadd
399:               rhvar(i,jlat+1-j,9) = work(i,j,9)*xscale + xadd
400:               rhvar(i,jlat+1-j,10) = work(i,j,10)*xscale + xadd
401:               rhvar(i,jlat+1-j,11) = work(i,j,11)*xscale + xadd
402:               rhvar(i,jlat+1-j,12) = work(i,j,13)*xscale + xadd
403:               rhvar(i,jlat+1-j,13) = work(i,j,15)*xscale + xadd
404:               rhvar(i,jlat+1-j,14) = work(i,j,17)*xscale + xadd
405:               rhvar(i,jlat+1-j,15) = work(i,j,18)*xscale + xadd
406:               rhvar(i,jlat+1-j,16) = work(i,j,20)*xscale + xadd
407:               rhvar(i,jlat+1-j,17) = work(i,j,22)*xscale + xadd
408:               rhvar(i,jlat+1-j,18) = work(i,j,24)*xscale + xadd
409:               rhvar(i,jlat+1-j,19) = work(i,j,26)*xscale + xadd
410:               rhvar(i,jlat+1-j,20) = work(i,j,28)*xscale + xadd
411:               rhvar(i,jlat+1-j,21) = work(i,j,31)*xscale + xadd
412:               rhvar(i,jlat+1-j,22) = work(i,j,34)*xscale + xadd
413:               rhvar(i,jlat+1-j,23) = work(i,j,37)*xscale + xadd
414:             end do
415:           end do
416:           do k = 1 , 23
417:             do j = 1 , jlat
418:               do i = 1 , ilon
419:                 rhvar(i,j,k) = amax1(rhvar(i,j,k)*0.01,0.00)
420:               end do
421:             end do
422:           end do
423:         else if ( kkrec==4 ) then
424:           do j = 1 , jlat
425:             do i = 1 , ilon
426: !             Uvar(i,jlat+1-j,k)=work(i,j,k)*xscale+xadd
427:               uvar(i,jlat+1-j,1) = work(i,j,1)*xscale + xadd
428:               uvar(i,jlat+1-j,2) = work(i,j,2)*xscale + xadd
429:               uvar(i,jlat+1-j,3) = work(i,j,3)*xscale + xadd
430:               uvar(i,jlat+1-j,4) = work(i,j,4)*xscale + xadd
431:               uvar(i,jlat+1-j,5) = work(i,j,5)*xscale + xadd
432:               uvar(i,jlat+1-j,6) = work(i,j,6)*xscale + xadd
433:               uvar(i,jlat+1-j,7) = work(i,j,7)*xscale + xadd
434:               uvar(i,jlat+1-j,8) = work(i,j,8)*xscale + xadd
435:               uvar(i,jlat+1-j,9) = work(i,j,9)*xscale + xadd
436:               uvar(i,jlat+1-j,10) = work(i,j,10)*xscale + xadd
437:               uvar(i,jlat+1-j,11) = work(i,j,11)*xscale + xadd
438:               uvar(i,jlat+1-j,12) = work(i,j,13)*xscale + xadd
439:               uvar(i,jlat+1-j,13) = work(i,j,15)*xscale + xadd
440:               uvar(i,jlat+1-j,14) = work(i,j,17)*xscale + xadd
441:               uvar(i,jlat+1-j,15) = work(i,j,18)*xscale + xadd
442:               uvar(i,jlat+1-j,16) = work(i,j,20)*xscale + xadd
443:               uvar(i,jlat+1-j,17) = work(i,j,22)*xscale + xadd
444:               uvar(i,jlat+1-j,18) = work(i,j,24)*xscale + xadd
445:               uvar(i,jlat+1-j,19) = work(i,j,26)*xscale + xadd
446:               uvar(i,jlat+1-j,20) = work(i,j,28)*xscale + xadd
447:               uvar(i,jlat+1-j,21) = work(i,j,31)*xscale + xadd
448:               uvar(i,jlat+1-j,22) = work(i,j,34)*xscale + xadd
449:               uvar(i,jlat+1-j,23) = work(i,j,37)*xscale + xadd
450:             end do
451:           end do
452:         else if ( kkrec==5 ) then
453:           do j = 1 , jlat
454:             do i = 1 , ilon
455: !             Vvar(i,jlat+1-j,k) =work(i,j,k)*xscale+xadd
456:               vvar(i,jlat+1-j,1) = work(i,j,1)*xscale + xadd
457:               vvar(i,jlat+1-j,2) = work(i,j,2)*xscale + xadd
458:               vvar(i,jlat+1-j,3) = work(i,j,3)*xscale + xadd
459:               vvar(i,jlat+1-j,4) = work(i,j,4)*xscale + xadd
460:               vvar(i,jlat+1-j,5) = work(i,j,5)*xscale + xadd
461:               vvar(i,jlat+1-j,6) = work(i,j,6)*xscale + xadd
462:               vvar(i,jlat+1-j,7) = work(i,j,7)*xscale + xadd
463:               vvar(i,jlat+1-j,8) = work(i,j,8)*xscale + xadd
464:               vvar(i,jlat+1-j,9) = work(i,j,9)*xscale + xadd
465:               vvar(i,jlat+1-j,10) = work(i,j,10)*xscale + xadd
466:               vvar(i,jlat+1-j,11) = work(i,j,11)*xscale + xadd
467:               vvar(i,jlat+1-j,12) = work(i,j,13)*xscale + xadd
468:               vvar(i,jlat+1-j,13) = work(i,j,15)*xscale + xadd
469:               vvar(i,jlat+1-j,14) = work(i,j,17)*xscale + xadd
470:               vvar(i,jlat+1-j,15) = work(i,j,18)*xscale + xadd
471:               vvar(i,jlat+1-j,16) = work(i,j,20)*xscale + xadd
472:               vvar(i,jlat+1-j,17) = work(i,j,22)*xscale + xadd
473:               vvar(i,jlat+1-j,18) = work(i,j,24)*xscale + xadd
474:               vvar(i,jlat+1-j,19) = work(i,j,26)*xscale + xadd
475:               vvar(i,jlat+1-j,20) = work(i,j,28)*xscale + xadd
476:               vvar(i,jlat+1-j,21) = work(i,j,31)*xscale + xadd
477:               vvar(i,jlat+1-j,22) = work(i,j,34)*xscale + xadd
478:               vvar(i,jlat+1-j,23) = work(i,j,37)*xscale + xadd
479:             end do
480:           end do
481:         else
482:         end if
483:       end do
484: 99001 format (i4,'/',a4,i4,'.00.nc')
485: 99002 format (i4,'/',a4,i4,'.06.nc')
486: 99003 format (i4,'/',a4,i4,'.12.nc')
487: 99004 format (i4,'/',a4,i4,'.18.nc')
488: 99005 format (i4,'/',a5,i4,'.00.nc')
489: 99006 format (i4,'/',a5,i4,'.06.nc')
490: 99007 format (i4,'/',a5,i4,'.12.nc')
491: 99008 format (i4,'/',a5,i4,'.18.nc')
492: !
493:       end subroutine ein756hour
494: 
<p><a name=headerein75><H3>headerein75</H3></a></p> Click <a href="./callingtree/headerein75_rite.html" TARGET=RITE_PANEL>HERE</a> to see the where headerein75 is used.
<hr>
495:       subroutine headerein75
496:       implicit none
497: !
498: ! Local variables
499: !
500:       integer :: i , j , k , kr
501: !
502:       sigmar(1) = .001
503:       sigmar(2) = .002
504:       sigmar(3) = .003
505:       sigmar(4) = .005
506:       sigmar(5) = .007
507:       sigmar(6) = .01
508:       sigmar(7) = .02
509:       sigmar(8) = .03
510:       sigmar(9) = .05
511:       sigmar(10) = .07
512:       sigmar(11) = .1
513:       sigmar(12) = .15
514:       sigmar(13) = .2
515:       sigmar(14) = .25
516:       sigmar(15) = .3
517:       sigmar(16) = .4
518:       sigmar(17) = .5
519:       sigmar(18) = .6
520:       sigmar(19) = .7
521:       sigmar(20) = .775
522:       sigmar(21) = .85
523:       sigmar(22) = .925
524:       sigmar(23) = 1.00
525: !
526: !     INITIAL GLOBAL GRID-POINT LONGITUDE & LATITUDE
527: !
528:       do i = 1 , ilon
529:         glon(i) = float(i-1)*0.75
530:       end do
531:       do j = 1 , jlat
532:         glat(j) = -90.0 + float(j-1)*0.75
533:       end do
534: !HH:OVER
535: !     CHANGE ORDER OF VERTICAL INDEXES FOR PRESSURE LEVELS
536: !
537:       do k = 1 , klev
538:         kr = klev - k + 1
539:         sigma1(k) = sigmar(kr)
540:       end do
541:  
542:       allocate(b3(jx,iy,klev*3))
543:       allocate(d3(jx,iy,klev*2))
544: 
545: !     Set up pointers
546: 
547:       u3 => d3(:,:,1:klev)
548:       v3 => d3(:,:,klev+1:2*klev)
549:       t3 => b3(:,:,1:klev)
550:       h3 => b3(:,:,klev+1:2*klev)
551:       q3 => b3(:,:,2*klev+1:3*klev)
552:       uvar => d2(:,:,1:klev)
553:       vvar => d2(:,:,klev+1:2*klev)
554:       tvar => b2(:,:,1:klev)
555:       hvar => b2(:,:,klev+1:2*klev)
556:       rhvar => b2(:,:,2*klev+1:3*klev)
557: 
558:       end subroutine headerein75
559: 
560:       end module mod_ein75
</PRE>

<HR>

</BODY>
</HTML>
