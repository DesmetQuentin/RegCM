!::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
!
!    This file is part of RegCM model.
!
!    RegCM model is free software: you can redistribute it and/or modify
!    it under the terms of the GNU General Public License as published by
!    the Free Software Foundation, either version 3 of the License, or
!    (at your option) any later version.
!
!    RegCM model is distributed in the hope that it will be useful,
!    but WITHOUT ANY WARRANTY; without even the implied warranty of
!    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
!    GNU General Public License for more details.
!
!    You should have received a copy of the GNU General Public License
!    along with RegCM model.  If not, see <http://www.gnu.org/licenses/>.
!
!::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

      module mod_aerosol

      use mod_regcm_param

      implicit none

!     MODIF 16/09/2005 IBRAH Internal mixing

!
! PARAMETER definitions
!
      integer , parameter :: nspi = 19
      integer , parameter :: ncoefs = 5
!
! number of coefficients
! kscoef  - specific extinction (m2/g)
! wscoef  - single partical albedo
! gscoef  - asymmetry parameter
! ksbase  - specific extinction (m2/g) base
! wsbase  - single partical albedo base
! gsbase  - asymmetry parameter base
! ksdust  - specific extinction (m2/g) dust
! wsdust  - single partical albedo dust
! gsdust  - asymmetry parameter dust
!
      integer , private :: ii , jj ! coefficient index
!
      real(8) , dimension(nspi) :: gsbase , gsbc_hb , gsbc_hl ,         &
                                 & gsoc_hb , gsoc_hl , ksbase ,         &
                                 & ksbc_hb , ksbc_hl , ksoc_hb ,        &
                                 & ksoc_hl , wsbase , wsbc_hb ,         &
                                 & wsbc_hl , wsoc_hb , wsoc_hl
      real(8) , dimension(nspi,ncoefs) :: gscoef , kscoef , wscoef
      real(8) , dimension(nspi,4) :: gsdust , ksdust , wsdust
      real(4) , dimension(4,19,11,11,11,11) :: dextmix , dgmix , dssamix

!
!     Aerosol mass mixing ratio
!
#ifdef MPP1
      real(8) , dimension(ixm1,kx,jxp) :: aermm
#else
      real(8) , dimension(ixm1,kx,jxm1) :: aermm
#endif

!
!     Background aerosol mass mixing ratio
!
      real(8) , dimension(ixm1,kx) :: aermmb

!
!     Radiation level aerosol mass mixing ratio
!
      real(8) , dimension(ixm1,kx,ntr) :: aermmr

!------------------------------------------------------------------------------
!                  DATA SECTION
!------------------------------------------------------------------------------

      data ksbase/5.206D0 , 5.206D0 , 5.206D0 , 5.206D0 , 5.206D0 ,     &
         & 5.206D0 , 5.206D0 , 3.203D0 , 3.203D0 , 1.302D0 , 5.992D-01 ,&
         & 2.948D-01 , 1.475D-01 , 7.387D-02 , 1.683D-01 , 2.655D-01 ,  &
         & 5.770D-02 , 2.290D-01 , 2.270D-01/
!
      data ((kscoef(ii,jj),jj=1,ncoefs),ii=1,nspi)/1.126D+01 ,          &
          & -2.502D-01 , -1.087D+00 , -1.794D+02 , 1.556D+01 ,          &
          & 1.126D+01 , -2.502D-01 , -1.087D+00 , -1.794D+02 ,          &
          & 1.556D+01 , 1.126D+01 , -2.502D-01 , -1.087D+00 ,           &
          & -1.794D+02 , 1.556D+01 , 1.126D+01 , -2.502D-01 ,           &
          & -1.087D+00 , -1.794D+02 , 1.556D+01 , 1.126D+01 ,           &
          & -2.502D-01 , -1.087D+00 , -1.794D+02 , 1.556D+01 ,          &
          & 1.126D+01 , -2.502D-01 , -1.087D+00 , -1.794D+02 ,          &
          & 1.556D+01 , 1.126D+01 , -2.502D-01 , -1.087D+00 ,           &
          & -1.794D+02 , 1.556D+01 , 1.124D+01 , -3.040D-01 ,           &
          & -1.088D+00 , -1.776D+02 , 1.537D+01 , 1.124D+01 ,           &
          & -3.040D-01 , -1.088D+00 , -1.776D+02 , 1.537D+01 ,          &
          & 1.222D+01 , -3.770D-01 , -1.089D+00 , -1.898D+02 ,          &
          & 1.504D+01 , 1.357D+01 , -4.190D-01 , -1.087D+00 ,           &
          & -2.070D+02 , 1.478D+01 , 1.557D+01 , -4.353D-01 ,           &
          & -1.083D+00 , -2.382D+02 , 1.486D+01 , 1.758D+01 ,           &
          & -4.389D-01 , -1.078D+00 , -2.716D+02 , 1.505D+01 ,          &
          & 1.597D+01 , -4.337D-01 , -1.073D+00 , -2.510D+02 ,          &
          & 1.527D+01 , 2.107D+01 , -3.041D-01 , -1.067D+00 ,           &
          & -2.494D+02 , 1.166D+01 , -2.424D-01 , -1.770D-01 ,          &
          & -1.032D+00 , 1.469D-01 , 1.947D+00 , 2.535D+01 ,            &
          & -2.270D-01 , -1.052D+00 , -2.528D+02 , 9.888D+00 ,          &
          & -1.545D-01 , -1.661D-01 , -1.030D+00 , -4.698D-04 ,         &
          & 7.275D-02 , 8.835D-01 , -1.590D-01 , -1.029D+00 ,           &
          & -2.838D+01 , 2.734D+01/
!
      data wsbase/7.371D-08 , 7.371D-08 , 7.371D-08 , 7.371D-08 ,       &
         & 7.371D-08 , 7.371D-08 , 7.371D-08 , 6.583D-08 , 6.583D-08 ,  &
         & 3.656D-06 , 4.919D-05 , 3.539D-03 , 2.855D-02 , 2.126D-01 ,  &
         & 8.433D-01 , 9.653D-01 , 6.198D-01 , 9.642D-01 , 9.699D-01/
!
      data ((wscoef(ii,jj),jj=1,ncoefs),ii=1,nspi)/2.492D+00 ,          &
          & -5.210D-02 , -1.036D+00 , -4.398D+01 , 1.724D+01 ,          &
          & 2.492D+00 , -5.210D-02 , -1.036D+00 , -4.398D+01 ,          &
          & 1.724D+01 , 2.492D+00 , -5.210D-02 , -1.036D+00 ,           &
          & -4.398D+01 , 1.724D+01 , 2.492D+00 , -5.210D-02 ,           &
          & -1.036D+00 , -4.398D+01 , 1.724D+01 , 2.492D+00 ,           &
          & -5.210D-02 , -1.036D+00 , -4.398D+01 , 1.724D+01 ,          &
          & 2.492D+00 , -5.210D-02 , -1.036D+00 , -4.398D+01 ,          &
          & 1.724D+01 , 2.492D+00 , -5.210D-02 , -1.036D+00 ,           &
          & -4.398D+01 , 1.724D+01 , 1.139D+00 , -1.110D-02 ,           &
          & -1.011D+00 , -7.754D+00 , 6.737D+00 , 1.139D+00 ,           &
          & -1.110D-02 , -1.011D+00 , -7.754D+00 , 6.737D+00 ,          &
          & 1.848D+00 , -3.920D-04 , -9.924D-01 , -1.607D+00 ,          &
          & 8.587D-01 , 5.459D+00 , 9.357D-01 , -1.626D+00 ,            &
          & -5.282D+00 , 1.066D+00 , 1.187D+00 , 2.241D-01 ,            &
          & -1.226D+00 , 1.442D+01 , -1.402D+01 , -3.640D+00 ,          &
          & 2.552D-01 , -1.168D+00 , 4.458D+01 , 1.152D+01 ,            &
          & -5.634D+00 , 2.068D-01 , -1.122D+00 , 7.528D+01 ,           &
          & 1.290D+01 , 1.826D-01 , 6.588D-02 , -1.098D+00 ,            &
          & -1.996D-02 , 1.618D-01 , 2.164D+00 , 1.194D-01 ,            &
          & -1.044D+00 , -3.221D+01 , 1.564D+01 , 2.268D-01 ,           &
          & 3.266D-02 , -1.064D+00 , -2.677D-02 , 1.309D-01 ,           &
          & 2.178D+00 , 1.151D-01 , -1.042D+00 , -3.325D+01 ,           &
          & 1.600D+01 , 1.713D+00 , 9.166D-02 , -1.039D+00 ,            &
          & -2.660D+01 , 1.629D+01/
!
      data gsbase/6.899D-01 , 6.899D-01 , 6.899D-01 , 6.899D-01 ,       &
         & 6.899D-01 , 6.899D-01 , 6.899D-01 , 6.632D-01 , 6.632D-01 ,  &
         & 5.912D-01 , 5.111D-01 , 4.269D-01 , 3.321D-01 , 2.197D-01 ,  &
         & 1.305D-01 , 7.356D-02 , 1.602D-01 , 6.883D-02 , 6.304D-02/
!
      data ((gscoef(ii,jj),jj=1,ncoefs),ii=1,nspi)/ - 9.874D-01 ,       &
          & -3.033D+01 , -2.138D+01 , -2.265D+00 , 5.238D+00 ,          &
          & -9.874D-01 , -3.033D+01 , -2.138D+01 , -2.265D+00 ,         &
          & 5.238D+00 , -9.874D-01 , -3.033D+01 , -2.138D+01 ,          &
          & -2.265D+00 , 5.238D+00 , -9.874D-01 , -3.033D+01 ,          &
          & -2.138D+01 , -2.265D+00 , 5.238D+00 , -9.874D-01 ,          &
          & -3.033D+01 , -2.138D+01 , -2.265D+00 , 5.238D+00 ,          &
          & -9.874D-01 , -3.033D+01 , -2.138D+01 , -2.265D+00 ,         &
          & 5.238D+00 , -9.874D-01 , -3.033D+01 , -2.138D+01 ,          &
          & -2.265D+00 , 5.238D+00 , -3.666D-01 , -1.319D+00 ,          &
          & -3.311D+00 , -2.821D-02 , 8.844D-01 , -3.666D-01 ,          &
          & -1.319D+00 , -3.311D+00 , -2.821D-02 , 8.844D-01 ,          &
          & 5.824D-01 , -1.875D-01 , -1.567D+00 , -4.402D+00 ,          &
          & 6.268D+00 , 1.238D+00 , -1.550D-01 , -1.368D+00 ,           &
          & -1.127D+01 , 8.334D+00 , 2.299D+00 , -1.686D-01 ,           &
          & -1.304D+00 , -2.677D+01 , 1.101D+01 , 3.037D+00 ,           &
          & -1.447D-01 , -1.223D+00 , -2.609D+01 , 8.267D+00 ,          &
          & 4.683D+00 , -2.307D-01 , -1.241D+00 , -4.312D+01 ,          &
          & 8.838D+00 , 3.842D+00 , -6.301D-01 , -1.367D+00 ,           &
          & -4.144D+01 , 9.620D+00 , 3.237D+00 , -4.530D-01 ,           &
          & -1.204D+00 , -3.234D+01 , 8.946D+00 , 4.181D+00 ,           &
          & -4.140D-01 , -1.284D+00 , -4.489D+01 , 9.950D+00 ,          &
          & 3.378D+00 , -4.334D-01 , -1.188D+00 , -3.664D+01 ,          &
          & 9.786D+00 , 3.943D+00 , -3.952D-01 , -1.170D+00 ,           &
          & -4.415D+01 , 1.031D+01/
!
!-----------------------------------------------------------------------
!
      data ksbc_hb/20.783 , 17.212 , 15.864 , 15.053 , 14.304 , 13.613 ,&
         & 11.966 , 6.5782 , 4.3961 , 4.38 , 2.11 , 2.11 , 2.11 , 2.11 ,&
         & 1.40 , 1.40 , 1.40 , 1.40 , 1.40/
 
      data wsbc_hb/0.24524 , 0.20962 , 0.195 , 0.18586 , 0.17719 ,      &
         & 0.16897 , 0.14849 , 0.071748 , 0.037536 , .089 , .025 ,      &
         & .025 , .025 , .025 , .009 , .009 , .009 , .009 , .009/
 
      data gsbc_hb/0.21387 , 0.17154 , 0.15564 , 0.1461 , 0.13732 ,     &
         & 0.12923 , 0.11006 , 0.049175 , 0.026638 , .220 , .123 ,      &
         & .123 , .123 , .123 , .073 , .073 , .073 , .073 , .073/
 
!----------------------------------------------------------------------

      data ksbc_hl/14.851 , 14.258 , 13.943 , 13.724 , 13.507 , 13.295 ,&
         & 12.722 , 9.4434 , 6.9653 , 4.38 , 2.11 , 2.11 , 2.11 , 2.11 ,&
         & 1.40 , 1.40 , 1.40 , 1.40 , 1.40/
 
      data wsbc_hl/0.46081 , 0.44933 , 0.44397 , 0.44065 , 0.43737 ,    &
         & 0.43394 , 0.42346 , 0.35913 , 0.29579 , .089 , .025 , .025 , &
         & .025 , .025 , .009 , .009 , .009 , .009 , .009/
 
      data gsbc_hl/0.69038 , 0.65449 , 0.63711 , 0.62542 , 0.61407 ,    &
         & 0.60319 , 0.57467 , 0.4205 , 0.3066 , .220 , .123 , .123 ,   &
         & .123 , .123 , .073 , .073 , .073 , .073 , .073/
 
!---------------------------------------------------------------------

      data ksoc_hb/6.0584 , 6.0654 , 6.1179 , 6.0102 , 5.8 , 5.6957 ,   &
         & 5.6494 , 4.3283 , 3.1485 , 1.302 , 5.992D-01 , 2.948D-01 ,   &
         & 1.475D-01 , 7.387D-02 , 1.683D-01 , 2.655D-01 , 5.770D-02 ,  &
         & 2.290D-01 , 2.270D-01/
 
      data wsoc_hb/0.91735 , 0.92365 , 0.92941 , 0.93067 , 0.93311 ,    &
         & 0.93766 , 0.94042 , 0.95343 , 0.9548 , 0.70566 , 0.70566 ,   &
         & 0.70566 , 0.70566 , 0.70566 , 0.70566 , 0.70566 , 0.70566 ,  &
         & 0.70566 , 0.70566/
 
      data gsoc_hb/0.67489 , 0.67003 , 0.67725 , 0.65487 , 0.65117 ,    &
         & 0.66116 , 0.64547 , 0.60033 , 0.55389 , 5.912D-01 ,          &
         & 5.111D-01 , 4.269D-01 , 3.321D-01 , 2.197D-01 , 1.305D-01 ,  &
         & 7.356D-02 , 1.602D-01 , 6.883D-02 , 6.304D-02/
 
!---------------------------------------------------------------------

      data ksoc_hl/3.543 , 3.623 , 3.7155 , 3.712 , 3.6451 , 3.6376 ,   &
         & 3.6844 , 3.4588 , 2.9846 , 1.302 , 5.992D-01 , 2.948D-01 ,   &
         & 1.475D-01 , 7.387D-02 , 1.683D-01 , 2.655D-01 , 5.770D-02 ,  &
         & 2.290D-01 , 2.270D-01/
 
      data wsoc_hl/0.87931 , 0.88292 , 0.89214 , 0.89631 , 0.89996 ,    &
         & 0.9054 , 0.90805 , 0.93423 , 0.95012 , 0.85546 , 0.85546 ,   &
         & 0.85546 , 0.85546 , 0.85546 , 0.85546 , 0.85546 , 0.85546 ,  &
         & 0.85546 , 0.85546/
 
      data gsoc_hl/0.73126 , 0.71089 , 0.72042 , 0.69924 , 0.69908 ,    &
         & 0.70696 , 0.68479 , 0.64879 , 0.63433 , 5.912D-01 ,          &
         & 5.111D-01 , 4.269D-01 , 3.321D-01 , 2.197D-01 , 1.305D-01 ,  &
         & 7.356D-02 , 1.602D-01 , 6.883D-02 , 6.304D-02/
 
!     DUST OP data base for external mixing : maximum of 4 bin for the
!     momeent , determined from Zender et al.
 
      data ((ksdust(ii,jj),jj=1,4),ii=1,nspi)/1.8801 , 0.76017 ,        &
          & 0.36681 , 0.16933 , 2.0254 , 0.78378 , 0.36845 , 0.17002 ,  &
          & 1.9547 , 0.76389 , 0.37119 , 0.17032 , 1.8996 , 0.74916 ,   &
          & 0.3722 , 0.17052 , 1.7946 , 0.74044 , 0.36984 , 0.17072 ,   &
          & 1.7149 , 0.75401 , 0.36892 , 0.1709 , 1.5431 , 0.82322 ,    &
          & 0.37505 , 0.17143 , 2.4482 , 0.8568 , 0.38078 , 0.17396 ,   &
          & 3.1067 , 0.74488 , 0.43688 , 0.18104 , 0.50391 , 0.67245 ,  &
          & 0.53605 , 0.20599 , 0.50391 , 0.67245 , 0.53605 , 0.20599 , &
          & 0.50391 , 0.67245 , 0.53605 , 0.20599 , 0.50391 , 0.67245 , &
          & 0.53605 , 0.20599 , 0.50391 , 0.67245 , 0.53605 , 0.20599 , &
          & 0.50391 , 0.67245 , 0.53605 , 0.20599 , 0.50391 , 0.67245 , &
          & 0.53605 , 0.20599 , 0.50391 , 0.67245 , 0.53605 , 0.20599 , &
          & 0.50391 , 0.67245 , 0.53605 , 0.20599 , 0.50391 , 0.67245 , &
          & 0.53605 , 0.20599/
 
      data ((wsdust(ii,jj),jj=1,4),ii=1,nspi)/0.64328 , 0.55196 ,       &
          & 0.53748 , 0.54342 , 0.67757 , 0.56909 , 0.53639 , 0.54232 , &
          & 0.67316 , 0.56027 , 0.53875 , 0.54181 , 0.66245 , 0.55338 , &
          & 0.53947 , 0.54149 , 0.68132 , 0.5744 , 0.54328 , 0.54143 ,  &
          & 0.6796 , 0.58467 , 0.54242 , 0.54113 , 0.72679 , 0.68744 ,  &
          & 0.58564 , 0.54576 , 0.9473 , 0.88181 , 0.80761 , 0.70455 ,  &
          & 0.97536 , 0.89161 , 0.86378 , 0.758 , 0.89568 , 0.96322 ,   &
          & 0.95008 , 0.89293 , 0.89568 , 0.96322 , 0.95008 , 0.89293 , &
          & 0.89568 , 0.96322 , 0.95008 , 0.89293 , 0.89568 , 0.96322 , &
          & 0.95008 , 0.89293 , 0.89568 , 0.96322 , 0.95008 , 0.89293 , &
          & 0.89568 , 0.96322 , 0.95008 , 0.89293 , 0.89568 , 0.96322 , &
          & 0.95008 , 0.89293 , 0.89568 , 0.96322 , 0.95008 , 0.89293 , &
          & 0.89568 , 0.96322 , 0.95008 , 0.89293 , 0.89568 , 0.96322 , &
          & 0.95008 , 0.89293/
 
      data ((gsdust(ii,jj),jj=1,4),ii=1,nspi)/0.87114 , 0.92556 ,       &
          & 0.94542 , 0.94831 , 0.86127 , 0.921 , 0.94355 , 0.94813 ,   &
          & 0.838 , 0.91194 , 0.94304 , 0.94803 , 0.8176 , 0.90442 ,    &
          & 0.94239 , 0.94796 , 0.77088 , 0.88517 , 0.9371 , 0.94775 ,  &
          & 0.73925 , 0.88364 , 0.93548 , 0.94763 , 0.60695 , 0.86086 , &
          & 0.91824 , 0.94473 , 0.64393 , 0.76457 , 0.8133 , 0.87784 ,  &
          & 0.7476 , 0.62041 , 0.80665 , 0.85974 , 0.26761 , 0.56045 ,  &
          & 0.68897 , 0.68174 , 0.26761 , 0.56045 , 0.68897 , 0.68174 , &
          & 0.26761 , 0.56045 , 0.68897 , 0.68174 , 0.26761 , 0.56045 , &
          & 0.68897 , 0.68174 , 0.26761 , 0.56045 , 0.68897 , 0.68174 , &
          & 0.26761 , 0.56045 , 0.68897 , 0.68174 , 0.26761 , 0.56045 , &
          & 0.68897 , 0.68174 , 0.26761 , 0.56045 , 0.68897 , 0.68174 , &
          & 0.26761 , 0.56045 , 0.68897 , 0.68174 , 0.26761 , 0.56045 , &
          & 0.68897 , 0.68174/
!
      end module mod_aerosol
