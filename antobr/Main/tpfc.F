      FUNCTION TPFC(PRESS,THETAE,TGS,D273,RL,QS,PI)
      IMPLICIT NONE
      REAL*8  PRESS,THETAE,TGS,D273,RL,QS,PI,TPFC
      REAL*8  RL461,RL1004,RP,ES,FO,T1,TGUESS,F1,DT
C
C...ITERATIVELY EXTRACT TEMPERATURE FROM EQUIVALENT POTENTIAL
C...TEMPERATURE.
C
      RL461=RL/461.5
      RL1004=RL/1004.
      RP=THETAE/PI
      ES=611.*DEXP(RL461*(D273-1./TGS))
      QS=.622*ES/(PRESS-ES)
      FO=TGS*DEXP(RL1004*QS/TGS)-RP
      T1=TGS-.5*FO
      TGUESS=TGS
   10 ES=611.*DEXP(RL461*(D273-1./T1))
      QS=.622*ES/(PRESS-ES)
      F1=T1*EXP(RL1004*QS/T1)-RP
      IF(ABS(F1).LT..1)GOTO 20
      DT=F1*(T1-TGUESS)/(F1-FO)
      TGUESS=T1
      FO=F1
      T1=T1-DT
      GOTO 10
C
   20 TPFC=T1
      RETURN
      END
